import{O as f,P as S}from"./oo_a1T_D.js";import{J as P,K as D,bA as R}from"./8xvvzpeQ.js";import{a as b}from"./DW-3PSLe.js";const U=async(e,t,r,o,u,s,i,l,d,y,w,a,g)=>{var m,p,T,I;try{let n=localStorage.getItem("_ud");n&&(n=JSON.parse(n));const B=P("am_id").value,k=P("am_fingerprint").value,E=i.funnelName||"funnel",{funnelPageId:O,funnelId:F,stepId:z}=i;t||(t=window.location.hostname,r=window.location.pathname);const h={altId:o,altType:"location",contactId:e,source:{type:g==="survey"?f.SURVEY:f.FORM,id:u,name:s,meta:{funnelId:F,funnelName:E,stepId:z,pageId:O,domain:t,pageUrl:r,affiliateManager:{id:B,fingerprint:k}}},products:l.map(c=>({id:c.id,qty:c.qty,isBump:"purchaseType"in c&&c.purchaseType==="bump"?!0:void 0,overridePrice:"overridePrice"in c&&c.overridePrice?c.overridePrice:void 0})),fingerprint:d,couponSessionId:w,couponCode:a,trackingId:D(),traceId:n==null?void 0:n.traceId};y&&(h.captchaToken=y);const v=await S.createOrder(h);if(!((m=v.order)==null?void 0:m._id))throw new Error("Something went wrong while creating order. Please try again later.");return v}catch(n){return console.error(n),{error:!0,message:(T=(p=n==null?void 0:n.response)==null?void 0:p._data)==null?void 0:T.message,status:(I=n==null?void 0:n.response)==null?void 0:I.status}}},_=async(e,t,r,o,u,s=!1)=>{try{const i={altId:e,altType:"location",source:{type:u==="survey"?f.SURVEY:f.FORM,id:t},products:r.map(d=>({id:d.id,qty:d.qty})),includeProductDetails:s,couponCode:o};return await S.getAmountSummary(i)}catch{throw new Error("Something went wrong while creating order. Please try again later.")}},K=e=>{let t=parseFloat(((e.price??e.amount)*e.qty).toFixed(2));return e.trialPeriod&&(t=0),t+(e.setupFee??0)},$=async(e,t)=>{try{return await S.getStoreProductById({productId:e,locationId:t,sendWishlistStatus:!1})}catch(r){return console.error(r),[]}},J=(e,t)=>`${b(t)||"$"}${e}`,V=e=>{const t=R.find(r=>r.value===e);return(t==null?void 0:t.imageUrl)||""},H=e=>e.uploadedImage||e.image;var C=(e=>(e.PRODUCT="product",e.DONATION="donation",e))(C||{});const W=e=>{var u;const t=Date.now(),r=window.performance,o={loadTime:t-e,startTimestamp:e,endTimestamp:t,totalBlockingTime:0,firstContentfulPaint:0,timeToInteractive:0,networkType:"unknown",cacheStatus:"unknown",cdnStatus:"unknown",pageSizeKB:0};try{const s=r.getEntriesByType("paint").find(a=>a.name==="first-contentful-paint");s&&(o.firstContentfulPaint=s.startTime);const i=r.getEntriesByType("longtask");o.totalBlockingTime=i.reduce((a,g)=>a+Math.max(0,g.duration-50),0);const l=r.getEntriesByType("navigation")[0];l&&(o.timeToInteractive=l.domContentLoadedEventEnd),o.networkType=((u=navigator==null?void 0:navigator.connection)==null?void 0:u.effectiveType)||"unknown";const d=r.getEntriesByType("resource").some(a=>a.transferSize===0);o.cacheStatus=d?"warm":"cold";const y=r.getEntriesByType("resource").some(a=>a.name.includes("cdn")||a.name.includes("cloudflare")||a.name.includes("akamai"));o.cdnStatus=y?"hit":"miss";const w=r.getEntriesByType("resource").reduce((a,g)=>{const m=g,p=m.transferSize>0?m.transferSize:m.encodedBodySize;return a+(p||0)},0);o.pageSizeKB=parseFloat((w/1024).toFixed(2))}catch(s){console.error("getPerformanceMetrics error:",s)}return o};export{C as F,_ as a,$ as b,K as c,V as d,H as e,J as f,W as g,U as h};
