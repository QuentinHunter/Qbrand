const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./TextElement.CqrgXvy-.css","./TextBoxListElement.BbmoZcvv.css","./RatingElement.DVwNReYk.css","./EmailElement.jE_nGMsg.css","./HeadingElement.m-g7VC6o.css","./CaptchaElement.CwYCMG1O.css","./CheckBoxElement.BEYyUWrc.css","./TermsAndConditionsElement.PhO3da8y.css","./RadioOptionElement.KosgWzkk.css","./vue-multiselect.B5exX717.css","./DatePick.CTXhwUy6.css","./DateElement.BEDGGAmD.css","./AuthorizeNetPaymentElement.CzbIxpAk.css","./ghl-payment-element.Dad5BXrt.css","./FormSurveyPayment.CO8FvRVm.css","./FileUploadElement.xXB1GlMw.css","./SignatureElement.C0yiJuTC.css","./FormSurveyAddressElement.EX39aLc-.css","./AddGuest.B5F3PTth.css","./AddGuestOld.D6GKKpwI.css","./OrderConfirmation.CERRXu7O.css","./ThanksMessage.CoXZSv2P.css","./RazorPayErrorPopup.-_LKMvYq.css","./CalendarPaymentPage.RnKiW0er.css"])))=>i.map(i=>d[i]);
var ei=Object.defineProperty;var ti=(l,i,_)=>i in l?ei(l,i,{enumerable:!0,configurable:!0,writable:!0,value:_}):l[i]=_;var No=(l,i,_)=>ti(l,typeof i!="symbol"?i+"":i,_);import{f as fe,g as Va,j as qr,r as p,v as $r,bg as Hr,aH as aa,au as Bo,bh as Da,D as Wr,I as jr,d as oi,aw as ai,ax as ri,c as le,T as ni,B as ii,o as Fr,n as ta,av as Er,ay as Ia,aN as li,A as Uo,i as Ca,bi as si,bj as di,J as Xe,aE as ci,aF as ui,h as oa,aJ as Pr,O as mi,a as O,b as oo,q as Fa,u as a,e as ao,s as ro,l as xe,m as xo,F as fi,p as pi,k as N,az as Z,bk as yi,aL as hi,aM as gi,bl as qt,aD as vi,bm as Ea,aT as _i,aG as bi,w as j,x as G,aB as wr,bn as Si}from"./8xvvzpeQ.js";import{S as Ii}from"./BPJmMdw_.js";import{_ as Ci}from"./B8edwuWm.js";import{_ as Fi}from"./BmIwalsL.js";import{_ as Ei}from"./BKG6-UcE.js";import{i as kr,b as Pi,e as wi,n as ki,_ as Ti,g as Ai,f as Vi}from"./BCGqgtjN.js";import{_ as Di}from"./v5HxUOio.js";/* empty css        */import{u as Li,_ as Oi}from"./D_c4xCym.js";import{w as Ri}from"./TNK_wdwi.js";/* empty css        */import{s as La,f as qo,g as Oa,b as $t,P as ra,a as Gr,i as Pa,d as zi,A as wa,e as ka}from"./oo_a1T_D.js";import{i as Ni,f as Tr}from"./WnAHhi8M.js";import{u as Ui,e as Mo,x as Ar,f as Ta,y as xi,h as Mi,z as Bi,j as Vr,k as qi}from"./Dmt1cPZn.js";import{L as Kr,l as Jr,C as Me}from"./DT7RoOeu.js";import{P as $i,a as Dr,n as Lr,o as na,q as Hi,f as Or,t as Wi,u as Rr,v as ji}from"./Cd5HuFSL.js";import{b as Gi,d as Ki,v as Ji,e as Yi}from"./Bg1KAb8C.js";import{a as Yr}from"./DPaKb6va.js";import{u as Qi,t as Zi}from"./DMPmGKrm.js";import{F as Je,g as zr,a as Xi,b as el}from"./64lVuDft.js";import{a as tl}from"./DW-3PSLe.js";import{_ as ol}from"./BrQJU4K_.js";import{l as al,g as Nr,G as Ur}from"./s9d8JekZ.js";import{s as rl}from"./D8y3k-bd.js";import{u as nl}from"./DII_iCb6.js";import{u as xr}from"./DCID7Uvk.js";import{c as Mr}from"./BcalUQVR.js";fe.extend(Yr);fe.extend(Kr);fe.extend(Jr);fe.extend(Qi);fe.extend(Zi);const Aa=fe.tz.guess(),il=["payment_intent","payment_intent_client_secret","redirect_status","sourceId","transactionId","altId","altType","setup_intent","setup_intent_client_secret"],ps=l=>["payment_intent","payment_intent_client_secret","redirect_status","setup_intent","setup_intent_client_secret"].some(i=>l[i]);class ys{constructor(){No(this,"state",Va({}));No(this,"newBaseUrl","");No(this,"t",qr().t);No(this,"newCardPaymentElementRef",p());const i=jr();this.newBaseUrl=i.public.newBaseURL,this.newCardPaymentElementRef=p(),this.state=Va({prev:!1,isInitialFetch:!0,timezone:Aa,calendarStartingDate:fe().tz(Aa).format("YYYY-M-D"),appointmentDate:void 0,calendarRange:{from:fe().tz(Aa).format("YYYY-M-D"),to:""},availableTimezones:[],selectedTimezone:void 0,selectedStaffMember:void 0,filterTimezone:"",formData:void 0,appointmentId:void 0,recurrenceId:void 0,appointmentIds:[],seqCall:0,isComponentLoading:!0,isLoading:!1,isFetchingSlots:!1,isBackButtonDisabled:!1,isSubmitting:!1,isNextMonthDisabled:!1,submissionError:"",paymentProcessingError:"",daySlots:{},availableTimes:[],showNoDates:!1,selectedSlot:null,showRecurringSlots:!1,recurringSlots:[],loadingRecurringSlots:!1,isRecurringSlotLoaded:!1,currentCalendarStep:0,isFormFirst:!1,cancellationNote:"",isCancelled:!1,showFullDescription:!1,locationAddress:void 0,formThankyouMessage:void 0,guests:[],guestCountDetail:[],guestCount:void 0,terms_and_conditions:null,widgetConfiguration:void 0,calendar:{},showCalendarDetails:!0,showAllBookingDetails:!1,isRescheduling:!1,showFullThankYouMessage:!1,isForReschedule:!1,isMobileVersion:!1,isTabletVersion:!1,isForSpecificService:!1,calendarProvider:{},calenderTimezone:"",use24hFormat:!1,contact:void 0,contact_id:void 0,isRecurring:!1,showLoadingScreen:!1,isPaymentProcessing:!1,isPaymentInitiated:!1,paymentRes:void 0,isPaymentEnabled:!1,stepInfo:{},formSubmissionData:{},fetchFreeSlots:!0,showDatePicker:!0,isPaymentWindowExpire:!1,uniqueId:$r(),autoNavigate:!1,shouldPayUsingPaymentElement:!0,paymentStatus:$i.PENDING,setAutomatically:!1,meetingLocationId:void 0,bookerMeetingLocation:void 0,isSameContact:void 0,paymentSessionTimeoutSeconds:600,formattedAppointmentDate:void 0,isCustomPaymentProvider:!1,bookedSlot:void 0,isCustomPaymentProviderLoaded:!1,startSessionExpireTimer:!1,traceId:"",paymentSessionId:void 0,urlParams:{},pageUrl:"",event:{},events:[],popup:!1,startDayOfWeek:1,disableContactTimezone:!1,serverError:"",noEventFound:!1,noCalendarError:!1,notes:"",thanksMsg:"",allLocationData:[],timezoneChangeState:!1,AMVisibleSlot:4,PMVisibleSlot:4,creatingAppointment:!1,calendarId:"",usePaymentElementInClassicWidget:!1,isProcessingRedirectPayment:!1,stepStartTime:0,analyticsSessionId:"",orderId:void 0,coupon:void 0,paymentEvent:{},isPaypalEnabled:!1,giftCardsSummary:[]})}setCustomState(i){["prev","isInitialFetch","timezone","calendarStartingDate","appointmentDate","calendarRange","availableTimezones","selectedTimezone","selectedStaffMember","filterTimezone","formData","appointmentId","recurrenceId","appointmentIds","seqCall","isComponentLoading","isLoading","isFetchingSlots","isBackButtonDisabled","isNextMonthDisabled","submissionError","paymentProcessingError","daySlots","availableTimes","showNoDates","selectedSlot","showRecurringSlots","recurringSlots","loadingRecurringSlots","currentCalendarStep","isFormFirst","cancellationNote","isCancelled","showFullDescription","locationAddress","guests","guestCountDetail","terms_and_conditions","widgetConfiguration","calendar","showCalendarDetails","showAllBookingDetails","isRescheduling","showFullThankYouMessage","isForReschedule","isMobileVersion","isTabletVersion","isForSpecificService","calendarProvider","calenderTimezone","use24hFormat","contact","contact_id","isRecurring","showLoadingScreen","isPaymentProcessing","isPaymentInitiated","isPaymentEnabled","stepInfo","formSubmissionData","fetchFreeSlots","showDatePicker","isPaymentWindowExpire","uniqueId","autoNavigate","shouldPayUsingPaymentElement","paymentStatus","setAutomatically","paymentSessionTimeoutSeconds","formattedAppointmentDate","isCustomPaymentProvider","bookedSlot","isCustomPaymentProviderLoaded","startSessionExpireTimer","traceId","paymentSessionId","isRecurringSlotLoaded","pageUrl","urlParams","event","events","popup","startDayOfWeek","disableContactTimezone","serverError","noEventFound","noCalendarError","notes","thanksMsg","allLocationData","timezoneChangeState","AMVisibleSlot","PMVisibleSlot","creatingAppointment","calendarId","usePaymentElementInClassicWidget","isSubmitting","analyticsSessionId","coupon","orderId","isPaypalEnabled","paymentEvent","giftCardsSummary"].forEach(f=>{i[f]!==void 0&&(this.state[f]=i[f])})}resetSelectedSlot(){this.state.paymentSessionId||(this.state.selectedSlot=void 0)}setCalendarBookingState(i){var P,w,X,o,F,ve,Be,qe,$e,Rt,zt;this.state.calendar=i.calendarService,this.state.isForReschedule=i.isForReschedule,this.state.isMobileVersion=i.isMobileVersion,this.state.isTabletVersion=i.isTabletVersion,this.state.use24hFormat=i.use24hFormat,this.state.isForSpecificService=i.isForSpecificService,this.state.calendarProvider=i.calendarProvider,this.state.calenderTimezone=i.calenderTimezone,this.state.isRecurring=!!((P=i==null?void 0:i.calendarService)!=null&&P.recurringRule);const _=(w=i.calendarService)==null?void 0:w.widget_config;_&&(this.state.widgetConfiguration={..._==null?void 0:_.primarySettings,default:(_==null?void 0:_.default)??!0});const f=Dr(i==null?void 0:i.queryParams);f&&(this.state.widgetConfiguration=f);const T=(X=_==null?void 0:_.pageOrder)==null?void 0:X.find(I=>I.kind==="form");!i.isForReschedule&&(i.queryParams.isFormFirst==="true"||(T==null?void 0:T.position)===0)?(this.state.isFormFirst=!0,this.setCurrentStep(Lr.FORM)):this.setCurrentStep(Lr.CALENDAR),(o=i.queryParams)!=null&&o.shouldPayUsingPaymentElement&&(this.state.shouldPayUsingPaymentElement=((F=i.queryParams)==null?void 0:F.shouldPayUsingPaymentElement)==="true"),(ve=i.queryParams)!=null&&ve.paymentSessionTimeoutSeconds&&(this.state.paymentSessionTimeoutSeconds=Number((Be=i.queryParams)==null?void 0:Be.paymentSessionTimeoutSeconds));const A=Dr(i.queryParams);this.state.isPaymentEnabled=((qe=this.state.calendar)==null?void 0:qe.stripe)&&Object(this.state.calendar.stripe).hasOwnProperty("amount"),this.state.isCustomPaymentProvider=((Rt=($e=this.state.calendar)==null?void 0:$e.stripe)==null?void 0:Rt.paymentProvider)==="custom-provider",A&&(i.widgetConfiguration=A),this.state.urlParams=i.urlParams,this.state.pageUrl=i.pageUrl,this.state.isPaypalEnabled=((zt=i.calendarService)==null?void 0:zt.isPayPalEnabled)||!1}setFormSubmissionData(i){var _,f,T,A,P,w;((_=this.state.contact)==null?void 0:_.id)===i.contact.id&&(this.state.isSameContact=!0),this.state.contact=i.contact,this.state.contact_id=(i==null?void 0:i.fingerprint)||((f=i==null?void 0:i.contact)==null?void 0:f.fingerprint)||((T=i==null?void 0:i.contact)==null?void 0:T.id),this.state.guests=((A=i==null?void 0:i.formData)==null?void 0:A.guests)||[],this.state.guestCount=(P=i==null?void 0:i.formData)==null?void 0:P.guestCount,this.state.terms_and_conditions=(w=i==null?void 0:i.formData)==null?void 0:w.terms_and_conditions,this.state.formSubmissionData={...i}}setCalendarBookingStateForConfirmationPage(i){var _,f;this.state.isRecurring?(this.state.recurrenceId=i.appointment.recurrenceId,this.state.appointmentIds=i.ids):this.state.appointmentId=i.appointment.id,this.state.locationAddress=i.event_address,this.state.bookedSlot=(_=this.state.selectedSlot)==null?void 0:_.format(),this.state.traceId=i==null?void 0:i.traceId,this.state.orderId=((f=i==null?void 0:i.appointment)==null?void 0:f.order_id)||(i==null?void 0:i.orderId),this.state.isPaymentEnabled&&Me.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"appointment_booked"})}setCurrentStep(i){this.state.currentCalendarStep=i}resetCalendarState(){this.state.showLoadingScreen=!1,this.state.isBackButtonDisabled=!1,this.state.appointmentId=void 0,this.state.recurrenceId=void 0,this.state.appointmentIds=[],this.state.locationAddress=void 0,this.state.formSubmissionData={},this.state.stepInfo={},this.state.contact=void 0,this.state.contact_id=void 0,this.state.guests=[],this.state.guestCount=void 0,this.state.terms_and_conditions=null,this.state.isPaymentWindowExpire=!1,this.state.selectedStaffMember=void 0,this.state.selectedSlot=void 0,this.state.isPaymentProcessing=!1,this.state.serverError="",this.state.coupon=void 0}async cancelCurrentAppointment(){try{await Me.cancelAppointment(this.state.appointmentId,this.state.cancellationNote||"Payment is failed")}catch(i){console.error("error on cancel appointment",i)}}setMeetingLocationId(i){this.state.meetingLocationId=i}setBookerMeetingLocation(i){this.state.bookerMeetingLocation=i}setStepInfo(i){this.state.stepInfo={...this.state.stepInfo,event_address:(i==null?void 0:i.address)||(i==null?void 0:i.eventAddress)}}async handleSubmit(i){var X,o,F,ve,Be,qe,$e,Rt,zt,I,$o,Ho,Wo,no,Ht,J,jo,io,Go,Ko,Ve,z,pe,Wt,Nt,Ye,Ut,Jo,Qe,lo,jt,Pe,Gt,Oe,Re,we;const _=!!((o=(X=this.state)==null?void 0:X.calendar)!=null&&o.recurringRule),f=((F=this.state.formSubmissionData)==null?void 0:F.formData)||{};if(this.state.calendar&&(f.location_id=this.state.calendar.location_id,f.calendar_id=this.state.calendar.id,f.selected_slot=(ve=this.state.selectedSlot)==null?void 0:ve.format(),f.selected_timezone=(Be=this.state.selectedTimezone)==null?void 0:Be.value),f.form_submission_id=(qe=this.state.formSubmissionData)==null?void 0:qe.submissionId,this.state.guests.length?f.guests=this.state.guests:this.state.guestCountDetail&&(f.guestCount=this.state.guestCount),this.state.contact&&(f.contact={id:($e=this.state.contact)==null?void 0:$e.id},((Rt=this.state.contact)==null?void 0:Rt.timezone)!==f.selected_timezone&&(f.contact.timezone=f.selected_timezone),f.contact_id=Hr(this.state.calendar.location_id),f.terms_and_conditions=(zt=this.state)==null?void 0:zt.terms_and_conditions,f.guests=(I=this.state)==null?void 0:I.guests,f.guestCount=this.state.guestCount,f.form_submission_id=($o=this.state.formSubmissionData)==null?void 0:$o.submissionId,((Ho=this.state.contact)!=null&&Ho.isNew||this.state.isSameContact)&&(f.is_new_contact=!0),f.skip_form_submit=!0),(Wo=this.state.calendar)!=null&&Wo.enable_same_user_assignment&&((no=this.state.contact)!=null&&no.assigned_to)&&!((Ht=this.state.calendar)!=null&&Ht.enable_staff_selection)){const y=(J=this.state.contact)==null?void 0:J.assigned_to,U=(jo=this.state.calendar)==null?void 0:jo.team_members.findIndex(et=>et.user_id===y);f.user_id=U>-1?y:null}((Go=(io=this.state)==null?void 0:io.selectedStaffMember)==null?void 0:Go.value)!==-1&&(f.user_id=(Ve=(Ko=this.state)==null?void 0:Ko.selectedStaffMember)==null?void 0:Ve.value),f.source="booking_widget";const T=this.newBaseUrl+"/appointment";if(this.state.calendar&&i.isNewCalendarWidgetEnabled){const y=document.getElementById("appointment-widgets-booking--revamp");y&&y.scrollIntoView({behavior:"smooth"})}let A=new FormData,P={};P.source="booking_widget";const w=Object.keys(f);for(const y of w)if(f[y]instanceof File)A.append(y,f[y]);else if((z=f[y])!=null&&z.files){const U=Object.values(f[y].files);U.length&&await Promise.all(U.map(et=>{A.append(y,et)}))}else(f[y]||f[y]===0)&&(P[y]=f[y]);if(this.state.meetingLocationId&&(P.meetingLocationId=this.state.meetingLocationId),this.state.bookerMeetingLocation&&(P.bookerMeetingLocation=this.state.bookerMeetingLocation),this.state.coupon&&(P.coupon={code:this.state.coupon.couponCode,chargeNow:this.state.coupon.chargeNow}),this.state.showLoadingScreen=!0,_)try{P.source="booking_widget",P.channel="private_api";const y=await Me.createRecurringEvents(Gi(P));y.ids&&y.ids.length&&(await this.handleRecurringEventData(y),this.setCalendarBookingStateForConfirmationPage({appointment:{recurrenceId:y.recurrenceId,order_id:y.orderId},event_address:y.eventAddress,traceId:y.traceId}),this.state.appointmentIds=y.ids),this.state.stepInfo={...this.state.stepInfo,...Ki(y)},this.state.showLoadingScreen=!1,na()}catch(y){this.state.showLoadingScreen=!1,console.error("error",y);let U="";return((Pe=y==null?void 0:y.response)==null?void 0:Pe.status)===502?U=((Oe=(Gt=y==null?void 0:y.response)==null?void 0:Gt.data)==null?void 0:Oe.msg)||"Something went wrong with your payment. Please try again.":U=((we=(Re=y==null?void 0:y.response)==null?void 0:Re.data)==null?void 0:we.msg)||this.t("unable_to_schedule_appointment"),this.processFormError({error:U}),{error:y}}else{this.state.isPaymentEnabled&&(P.paymentMeta={status:"pending"}),A.set("formData",JSON.stringify(P));try{let y={};const U=await $fetch(T,{method:"POST",body:A});this.setCalendarBookingStateForConfirmationPage(U),this.state.showLoadingScreen=!1,this.state.stepInfo={...this.state.stepInfo,...U},U&&(y=await aa(U==null?void 0:U.contact,!0),y={...y,appointment:U==null?void 0:U.appointment},Bo("_ud",JSON.stringify(y))),La({sessionId:(U==null?void 0:U.sessionId)||null,locationId:this.state.calendar.location_id});const M=U==null?void 0:U.sessionFingerprint;return M&&qo(this.state.calendar.location_id,M),na(),U}catch(y){this.state.showLoadingScreen=!1,console.error("error",y);let U="";return((pe=y==null?void 0:y.response)==null?void 0:pe.status)===502?U=((Nt=(Wt=y==null?void 0:y.response)==null?void 0:Wt._data)==null?void 0:Nt.message)||((Ut=(Ye=y==null?void 0:y.response)==null?void 0:Ye.data)==null?void 0:Ut.msg)||"Something went wrong with your payment. Please try again.":U=((Qe=(Jo=y==null?void 0:y.response)==null?void 0:Jo._data)==null?void 0:Qe.message)||((jt=(lo=y==null?void 0:y.response)==null?void 0:lo.data)==null?void 0:jt.msg)||this.t("unable_to_schedule_appointment"),this.processFormError({error:U}),{error:y}}}}async handleRecurringEventData(i){let _=i.fingerprint;i.sessionFingerprint;let f={};try{const T="_ud";return f=await aa(i.contact,!0),this.state.calendar&&(f={...f,appointment:i.appointment}),Bo(T,JSON.stringify(f)),Da(this.state.calendar.location_id,_),window.parent.postMessage(["set-sticky-contacts",T,JSON.stringify(f),this.state.calendar.location_id,_],"*"),f}catch(T){const A=window,P={formData:i,eventId:i.ids.join(","),error:T==null?void 0:T.stack,isUserSessionLoad:window.userSessionAttribution,logs:A.ConsoleSubscriber?A.ConsoleSubscriber.getErrors():[]};throw Me.appointmentBookingLogs(this.state.traceId,P),T}}processFormError(i){i&&i.error&&(this.state.submissionError=i.error),this.state.isBackButtonDisabled=!1}async updateAppointment(){var T;const i=this.newBaseUrl+"/appointment",_={event_id:this.state.appointmentId,source:"booking_widget"};this.state.isPaymentEnabled&&(_.payment_meta={status:"completed"}),this.state.calendar&&(_.location_id=this.state.calendar.location_id,_.calendar_id=this.state.calendar.id,_.eventData=(T=this.state.contact)==null?void 0:T.formData);let f=new FormData;f.set("formData",JSON.stringify(_));try{const A=await $fetch(i,{method:"POST",body:f})}catch(A){console.log("error on payment update",A)}}async invalidateAppointment(){const{appointmentId:i,calendar:_,isRecurring:f,appointmentIds:T}=this.state;try{const A={event_id:i,calendar_id:_==null?void 0:_.id,location_id:_==null?void 0:_.location_id,appointment_status:"invalid",to_notify:!1};let P;return f?P=await Promise.all(T.map(w=>(A.event_id=w,$fetch(this.newBaseUrl+"/appointment",{method:"POST",body:A})))):P=await $fetch(this.newBaseUrl+"/appointment",{method:"POST",body:A}),P}catch(A){console.error("Error on invalidate appointment :",A)}}async updatePaymentDetailInEvent(){var i,_,f,T,A,P,w,X,o;if(Me.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"payment_update_started"}),!!this.state.isPaymentEnabled){try{const F={eventId:this.state.appointmentId,source:"booking_widget"};if(this.state.isPaymentEnabled&&(F.paymentMeta={status:"completed",transactionId:(i=this.state.paymentRes)==null?void 0:i.transactionId,orderId:(f=(_=this.state.calendar)==null?void 0:_.feature_flags)!=null&&f.couponsEnabled?this.state.orderId:void 0,...this.state.isRecurring?{recurrenceCount:this.state.recurringSlots.length||1,recurringPaymentType:this.state.calendar.stripe.recurring_appointments_payment_type}:{}}),this.state.calendar){F.locationId=this.state.calendar.location_id,F.calendarId=this.state.calendar.id,F.eventData=(A=(T=this.state.formSubmissionData)==null?void 0:T.formData)==null?void 0:A.eventData,F.meetingLocationId=this.state.meetingLocationId,F.bookerMeetingLocation=this.state.bookerMeetingLocation,F.chargeId=(P=this.state.paymentRes)==null?void 0:P.chargeId,F.formId=this.state.calendar.form_id,F.formSubmissionId=(w=this.state.formSubmissionData)==null?void 0:w.submissionId;const qe=Oa(this.state.calendar.location_id),$e=$t(this.state.calendar.location_id);F.sessionFingerprint=$e,F.sessionId=qe,((X=this.state.contact)!=null&&X.isNew||this.state.isSameContact)&&(F.isNewContact=!0)}let ve;if(this.state.isRecurring){const qe=((o=this.state.formSubmissionData)==null?void 0:o.ids)||[];ve=(await Me.updatePaymentDetailForRecurringAppointments(this.state.recurrenceId,F))[0]}else ve=await Me.updatePaymentDetail(this.state.appointmentId,F);this.setStepInfo(ve);const Be=ve==null?void 0:ve.sessionFingerprint;Be&&qo(this.state.calendar.location_id,Be)}catch(F){console.error("error on payment update",F),Me.appointmentBookingLogs(this.state.traceId,{eventId:this.state.appointmentId,message:"payment_update_failed",error:F})}Hi(this.state.calendar.id)}}async verifyRedirectPayment(i,_){Wr();const f=i.payment_intent,T=i.transactionId,A=i.setup_intent,P=i.redirect_status;if(f){this.state.showLoadingScreen=!0;const w=await this.verifyRedirectedPayment(f,A,_,T);if(this.state.showLoadingScreen=!1,w)return"success"}else if(A&&P==="succeeded")return"success";return this.state.paymentProcessingError=this.t("payment_process_error"),"failed"}async verifyRedirectedPayment(i,_,f,T){var A;try{const P=(A=this.state.calendar)==null?void 0:A.location_id;let w;if(T){const X={altId:P,altType:"location",transactionId:T};w=await ra.verifyGenernalPayment(X)}if(f){const X={altId:P,altType:"location",orderId:f,paymentIntentId:i,setupIntentId:_,isAuth:!!_,attribution:{eventData:Gr(),sessionId:Oa(P),sessionFingerprint:$t(P)}};w=await ra.verifyStripePayment(X)}if(w.success)return w;throw new Error(w.message)}catch{return this.state.paymentProcessingError=this.t("payment_process_error"),this.state.isBackButtonDisabled=!1,!1}}isAppointmentBookedAndPaymentFailed(){var i,_;return((i=this.state)==null?void 0:i.appointmentId)&&((_=this.state)==null?void 0:_.paymentProcessingError)}}const Br=(l,i,_)=>{try{let f=Object.keys(l.errors).filter(w=>l.errors[w]);if(f.length===0&&l.validationError.captcha&&(f=["captcha"]),f.length===0)return;const T=f[0];if(T==="captcha"){const w=document.querySelector("[data-sitekey]")||document.querySelector(".g-recaptcha")||document.querySelector('[id*="captcha"]')||document.querySelector(".recaptcha-container");w&&w.scrollIntoView({behavior:"smooth",block:"start"});return}if(T==="payment"){const w=document.querySelector(".payment-block");w&&w.scrollIntoView({behavior:"smooth",block:"start"});return}if(T==="address"){const w=document.querySelector(".address-wrapper")||document.querySelector('[data-field-name="address"]')||document.querySelector('input[placeholder*="address" i]')||document.querySelector('input[placeholder*="search" i]');if(w){w.scrollIntoView({behavior:"smooth",block:"start"});const X=w.querySelector("input, textarea, select");X&&setTimeout(()=>{X.focus()},500)}return}const A=i.findIndex(w=>w.tag===T);let P=null;if(A!==-1){const w=`el_${_}_${T}_${A}`;P=document.getElementById(w)}if(!P){const w=document.querySelectorAll(`[id^="el_${_}_${T}_"]`);w.length>0&&(P=w[0])}if(P||(P=document.getElementById(T)||document.querySelector(`[name="${T}"]`)||document.querySelector(`[data-q="${T}"]`)||document.querySelector(`[data-field-tag="${T}"]`)),P){P.scrollIntoView({behavior:"smooth",block:"start"});const w=P.querySelector("input, textarea, select");w&&setTimeout(()=>{w.focus()},500)}}catch(f){console.error("scrollToFirstErrorField error:",f)}},ll=j(()=>G(()=>import("./gspkBITe.js"),[],import.meta.url).then(l=>l.default||l)),sl=j(()=>G(()=>import("./f-w9390m.js"),__vite__mapDeps([0]),import.meta.url).then(l=>l.default||l)),dl=j(()=>G(()=>import("./BII-BBHI.js"),__vite__mapDeps([1]),import.meta.url).then(l=>l.default||l)),cl=j(()=>G(()=>import("./DZ_-ue_p.js"),__vite__mapDeps([2]),import.meta.url).then(l=>l.default||l)),ul=j(()=>G(()=>import("./DBnOGnli.js"),__vite__mapDeps([3]),import.meta.url).then(l=>l.default||l)),ml=j(()=>G(()=>import("./BKlzrVD3.js"),__vite__mapDeps([4]),import.meta.url).then(l=>l.default||l)),fl=j(()=>G(()=>import("./DNAPAI4s.js"),[],import.meta.url).then(l=>l.default||l)),pl=j(()=>G(()=>import("./BBLHkdqM.js"),__vite__mapDeps([5]),import.meta.url).then(l=>l.default||l)),yl=j(()=>G(()=>import("./D0vZKkIG.js"),__vite__mapDeps([1]),import.meta.url).then(l=>l.default||l)),hl=j(()=>G(()=>import("./BcbRMslp.js"),__vite__mapDeps([6]),import.meta.url).then(l=>l.default||l)),gl=j(()=>G(()=>import("./Dft1FZUV.js"),__vite__mapDeps([7]),import.meta.url).then(l=>l.default||l)),vl=j(()=>G(()=>import("./BynPnKa2.js"),__vite__mapDeps([8]),import.meta.url).then(l=>l.default||l)),_l=j(()=>G(()=>import("./xyGoWrr2.js"),__vite__mapDeps([1]),import.meta.url).then(l=>l.default||l)),bl=j(()=>G(()=>import("./1ucATXd9.js"),__vite__mapDeps([9]),import.meta.url).then(l=>l.default||l)),Sl=j(()=>G(()=>import("./Cpejf19C.js"),__vite__mapDeps([10,11]),import.meta.url).then(l=>l.default||l)),Il=j(()=>G(()=>import("./DEOy3-wF.js"),[],import.meta.url).then(l=>l.default||l)),Cl=j(()=>G(()=>import("./PY167D3V.js"),__vite__mapDeps([12]),import.meta.url).then(l=>l.default||l)),Fl=j(()=>G(()=>import("./CQlZlZhx.js"),__vite__mapDeps([13,14,9]),import.meta.url).then(l=>l.default||l)),El=j(()=>G(()=>import("./D6nCrx5z.js"),__vite__mapDeps([15]),import.meta.url).then(l=>l.default||l)),Pl=j(()=>G(()=>import("./oJp2h3Pv.js"),__vite__mapDeps([16]),import.meta.url).then(l=>l.default||l)),wl=j(()=>G(()=>import("./D-EyuI2V.js"),__vite__mapDeps([0,17]),import.meta.url).then(l=>l.default||l)),kl=j(()=>G(()=>import("./CKuk01m5.js"),__vite__mapDeps([18]),import.meta.url).then(l=>l.default||l)),Tl=j(()=>G(()=>import("./Bk2kGPhp.js"),__vite__mapDeps([19]),import.meta.url).then(l=>l.default||l)),Al=j(()=>G(()=>import("./BmDW8KYK.js"),[],import.meta.url).then(l=>l.default||l)),Vl=j(()=>G(()=>import("./DUfTI8SO.js"),__vite__mapDeps([20]),import.meta.url).then(l=>l.default||l)),Dl=j(()=>G(()=>import("./COKQhOVB.js"),__vite__mapDeps([21]),import.meta.url).then(l=>l.default||l)),Ll=j(()=>G(()=>import("./CJE84Lcj.js"),__vite__mapDeps([13,22,23]),import.meta.url).then(l=>l.default||l)),Ol={ref:"hl-app",class:"hl-app"},Rl={key:0},zl=["id","onFocusin","onClick","onFocus"],Nl={key:0,class:"col-sm-12 col-12"},Ul={class:"loader-container"},hs=oi({__name:"FormComponent",props:{formId:{type:String,default:void 0},formData:{type:Object||Array,required:!0},calendar:{type:Object,default:void 0},selectedSlot:{type:Object,default:void 0},timezone:{type:String,default:void 0},event:{type:Object,default:void 0},error:{type:String,default:void 0},redirect:{type:Boolean,default:!0},funnelPreview:{type:Boolean,default:!1},extra:{type:Object,default:{}},formElementClass:{type:String,required:!1},calendarEventId:{type:String,required:!1},forCalendarV3:{type:Boolean,default:!1},pageUrl:{type:String,default:void 0},baseReferrrer:{type:String,default:void 0},urlParams:{type:Object,default:void 0},stickyContactData:{type:Object,default:void 0},stickyContactFingerprint:{type:String,default:void 0},iFrameId:{type:String,default:void 0},guests:{type:Array,default:[]},guestCountDetail:{type:Object,default:{}},seatsPerSlotData:{type:Object,default:{availableSeats:0,enableGuestSeating:!1}},calendarConfirmationButtonText:{type:String,default:void 0},isNewCalendarWidgetEnabled:{type:Boolean,default:!1},formSubmissionInstruction:{type:Object,default:{onlySubmitForm:!1,isRecurring:!1,shouldPayUsingPaymentElement:!1,totalRecurringBookings:1}},calendarMeetingLocationDetails:{type:Object,default:{meetingLocationId:void 0,bookerMeetingLocation:void 0,validateMeetingLocation:void 0}},calendarServiceHelper:{type:Object,default:{}},locale:{type:String,default:"en"},isCalendarService:{type:Boolean,default:!1}},emits:["step","processError","disableBackOnSubmit","onSubmit","onFormSubmitCallback","onProcessCalendarPayment"],async setup(l,{expose:i,emit:_}){var hr,gr,vr,_r,br;let f,T;fe.extend(Jr),fe.extend(Yr),fe.extend(Kr);const{t:A}=qr(),{addHeaderFromCookieForReferer:P}=gi(),{redirectAction:w}=nl(),X=jr(),o=l;xr({link:[{rel:"stylesheet",href:"https://stcdn.leadconnectorhq.com/intl-tel-input/17.0.12/css/intlTelInput.min.css"}],script:[{src:"https://stcdn.leadconnectorhq.com/libphonenumber/1.10.60/libphonenumber-js.min.js",async:!0,type:"text/javascript"},{src:"https://stcdn.leadconnectorhq.com/intl-tel-input/17.0.12/js/utils.min.js",async:!0,type:"text/javascript"},{src:"https://stcdn.leadconnectorhq.com/intl-tel-input/intlTelInput.min.js",async:!0,type:"text/javascript"}]});const F=Wr();let ve={},Be={},qe={},$e=p(!0),Rt={},zt=p(!1),I=p([]),$o={},Ho={},Wo={},no=p(""),Ht=p(!1),J=p(!0),jo={},io=p(!1),Go={},Ko={},Ve=p(!1),z=p(""),pe=p(!1),Wt=p("US"),Nt=p(),Ye=p("");p("");let Ut=p(""),Jo=p([]),Qe=p(!1);const lo=p("");let jt=p(),Pe=p({}),Gt=p(!0),Oe=p(""),Re=p(),we=p(),y=p(),U=p(),et=p(),M=p(),He=p(),Yo=p(),Qr={},ia=p(),B=p([]),la=p(!1);const Ra=p(!1),Kt=p(""),so=p(),e=Va({phoneCountryIncluded:ve,phoneCountryCode:qe,formattedPhone:Be,form:Rt,formStyle:$o,buttonStyle:Ho,company:jo,formFieldsValue:Go,validationError:Ko,fieldStyle:Wo,errors:Qr}),sa=p(),da=p(),ca=p(),Qo=p(),ua=p({}),za=p(),Jt=p(),co=p(),ma=p(),uo=p(),mo=p(),ye=p({paymentType:Je.DONATION,orderId:void 0}),Na=p({}),fo=p(!1),tt=p([]),Yt=p({}),Ua=p(),po=p(!!(F.query.payment_intent||F.query.setup_intent)),Qt=p({}),yo=p([]),Zo=p(),Zt=p(!1),Xt=p(),xt=p(ai()||ri()),xa=p([]),{getFormStyle:Zr,setFormStyle:Xr,getFormWidth:fa,hasCustomMarginTop:en,getMarginStyle:tn}=Ui(),{authorizeNetDispatchData:on,setAuthorizeNetErrorResponse:pa,authorizeNetErrorResponse:an,authorizeNetCardNumberError:Ma,authorizeNetCardExpiryError:Ba,authorizeNetCardCVCError:qa,setAuthorizeNetCardNumberError:$a,setAuthorizeNetExpiryError:Ha,setAuthorizeNetCVCError:Wa,clearAuthorizeNetNewCardFormErrors:rn}=Li(),ja=p(0),ya=p(null),nn=le(()=>e.form.payment.liveModeOn?X.public.STRIPE_DEFAULT_CONFIGURATION_LIVE_FORM:X.public.STRIPE_DEFAULT_CONFIGURATION_TEST_FORM),ho=()=>{Xt.value=void 0,Zt.value=!1},ln=t=>{Xt.value=t},Ga=(t,r=!1)=>r&&t==="submit"?!1:Ea.indexOf(t)>=0,sn={bgColor:"E9ECEFFF",labelColor:((hr=e==null?void 0:e.fieldStyle)==null?void 0:hr.labelColor)||"",placeholderColor:"",border:"",width:"",padding:{top:15,bottom:15,left:20,right:20},shadow:""},dn=t=>{var r,n;uo.value=t,e.formFieldsValue.payment=((n=(r=e.form)==null?void 0:r.payment)==null?void 0:n.currency.symbol)+t},cn=t=>{var r;Qt.value=t,yo.value=t.items.map(n=>{var s;return{...n,id:n._id,amount:n.price.amount,bumpProduct:!!n.bumpProduct,funnel:he.value.funnelId,step:he.value.stepId,locationId:he.value.locationId,max:t.max,couponCode:(s=t.coupon)==null?void 0:s.code}}),ye.value.orderId=t._id,ye.value.paymentType=Je.PRODUCT,ye.value.amount=t.amount,ye.value.currency=t.currency,ye.value.isRecurringDonation=(r=t==null?void 0:t.meta)==null?void 0:r.isRecurringDonation},un=t=>{e.formFieldsValue.emailVerified=t},Ka=t=>{e.formFieldsValue.phoneVerified=t},ha=t=>{Array.isArray(e.formFieldsValue.tokens)||(e.formFieldsValue.tokens=[]),e.formFieldsValue.tokens.push(t)},mn=()=>{if(o.calendar&&e.form.fullScreenMode)return{padding:"20px !important"};if(e.form.fullScreenMode)return{padding:"0px !important"}},fn=le(()=>({...tn(),...mn()||{}})),pn=(t,r)=>e.form.layout===qt.ONE_COLUMN?"col-12":(e.form.layout===qt.TWO_COLUMN||e.form.layout===!0)&&!Ga(t.type)&&vo(r)?(t==null?void 0:t.fieldWidthPercentage)<=50||!o.formId?"menu-field-wrap col-sm-6 col-6":"col-12":e.form.layout===qt.SINGLE_LINE?"menu-field-wrap col-12":"col-12",yn=(t,r)=>{let n="";return(!Ga(t.type,!1)||e.form.layout===qt.SINGLE_LINE&&t.type=="submit")&&(n=`
    @media screen and (min-width: 1025px) {
        #el_${o.formId}_${t.tag+"_"+r} {
        max-width: ${t.fullwidth?"100":t.fieldWidthPercentage}%;
        width: ${t.fullwidth?"100":t.fieldWidthPercentage}% !important;
        flex: 0 0 ${t.fullwidth?"100":t.fieldWidthPercentage}% !important;
      }
    `),n},hn=t=>({marginBottom:gn(t)}),gn=t=>{var r,n;return t.hidden?0:(n=(r=e.form)==null?void 0:r.style)!=null&&n.hasOwnProperty("fieldSpacing")?e.form.style.fieldSpacing+"px":"16px"},vn=()=>e.form.layout===qt.ONE_COLUMN?Ai(e.form.fieldStyle.labelWidth):"",Ja=p(""),ga=t=>{B.value.push(t)},_n=t=>t?"@import url('https://fonts.bunny.net/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i');":"@import url('https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i');",bn=async()=>{var x,H,K,m,u,oe,ie,se,de,ce,ee,ue,Y,D,q,W,R,C,S,$,me,re,Q,ae,De,ke,Te,Ze,je,rt,nt,d,V,ze,it,lt,st,dt,ct,ut,mt,ft,pt,yt,ht,gt,vt,_t,bt,St,It,b,E,k,L,_e,be,Se,Ie,Ce,Ne,Ae,Ue,Fe,Ct,Ft,Et,Ge,Pt,wt,kt,Ke,Tt,At,Vt,Dt,Le,Lt,ge,Ee,Bt,bo,So,Io,Co,Fo,Eo,Po,wo,ko,To,Ao,Vo,Do,Lo,Oo,Ro,zo,v,Sr,Ir,Cr;const{locationId:t,form:r,country:n,companyId:s,recurringProductId:h}=o.formData;if(!t||!r)return;e.form=Mr(r),e.form.recurringProductId=h,Ut.value=(x=e.form)==null?void 0:x.fbPixelId,z.value=t,Wt.value=n,Qe.value="stickyContact"in e.form?(H=e.form)==null?void 0:H.stickyContact:!1,Ua.value=_n(e.form.isGDPRCompliant);const g=o.formElementClass?`.${o.formElementClass}${wr}`:wr;if("layout"in e.form&&(Ht.value=[!0,qt.TWO_COLUMN,qt.SINGLE_LINE].includes((K=e.form)==null?void 0:K.layout)),(u=(m=e.form)==null?void 0:m.fieldStyle)!=null&&u.labelAlignment&&(Ja.value=vn()),"fields"in e.form&&(I.value=[...(oe=e.form)==null?void 0:oe.fields]),"style"in e.form){Xr({...(ie=e==null?void 0:e.form)==null?void 0:ie.style,padding:xt.value?((de=(se=e==null?void 0:e.form)==null?void 0:se.style)==null?void 0:de.mobilePadding)||((ee=(ce=e==null?void 0:e.form)==null?void 0:ce.style)==null?void 0:ee.padding):(Y=(ue=e==null?void 0:e.form)==null?void 0:ue.style)==null?void 0:Y.padding,margin:xt.value?((q=(D=e==null?void 0:e.form)==null?void 0:D.style)==null?void 0:q.mobileMargin)||((R=(W=e==null?void 0:e.form)==null?void 0:W.style)==null?void 0:R.margin):(S=(C=e==null?void 0:e.form)==null?void 0:C.style)==null?void 0:S.margin},($=e==null?void 0:e.form)==null?void 0:$.width),so.value=xt.value?((re=(me=o==null?void 0:o.formData)==null?void 0:me.form)==null?void 0:re.mobileFieldCSS)||((ae=(Q=o==null?void 0:o.formData)==null?void 0:Q.form)==null?void 0:ae.fieldCSS):(ke=(De=o==null?void 0:o.formData)==null?void 0:De.form)==null?void 0:ke.fieldCSS,so.value&&!Pa()&&o.formElementClass&&(so.value=so.value.replace(/#_builder-form/g,`.${o.formElementClass} #_builder-form`)),io.value=((Ze=(Te=e.form)==null?void 0:Te.style)==null?void 0:Ze.ac_branding)??((rt=(je=e.form)==null?void 0:je.style)==null?void 0:rt.acBranding);const Ot=xt.value&&((d=(nt=e.form)==null?void 0:nt.style)!=null&&d.mobileBgImage)?(ze=(V=e.form)==null?void 0:V.style)==null?void 0:ze.mobileBgImage:(lt=(it=e.form)==null?void 0:it.style)==null?void 0:lt.bgImage;Ot&&(lo.value=`${o.funnelPreview?`.${o.formElementClass} #form-builder`:"body"} {background-image: url('${Ot}');
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        background-position: top center}`)}((ct=(dt=(st=e.form.formAction)==null?void 0:st.headerImageSrc)==null?void 0:dt.trim())==null?void 0:ct.length)>0&&(Kt.value=e.form.formAction.headerImageSrc),xt.value&&((ft=(mt=(ut=e.form.formAction)==null?void 0:ut.mobileHeaderImageSrc)==null?void 0:mt.trim())==null?void 0:ft.length)>0&&(Kt.value=e.form.formAction.mobileHeaderImageSrc),"button"in e.form&&(e.buttonStyle={bgColor:(yt=(pt=e.form)==null?void 0:pt.button)==null?void 0:yt.background,color:(gt=(ht=e.form)==null?void 0:ht.button)==null?void 0:gt.color,border:((bt=(_t=(vt=e.form)==null?void 0:vt.button)==null?void 0:_t.border)==null?void 0:bt.border)||0,borderColor:((b=(It=(St=e.form)==null?void 0:St.button)==null?void 0:It.border)==null?void 0:b.color)||Si,radius:(L=(k=(E=e.form)==null?void 0:E.button)==null?void 0:k.border)==null?void 0:L.radius,padding:(Se=(be=(_e=e.form)==null?void 0:_e.button)==null?void 0:be.border)==null?void 0:Se.padding}),(Ce=(Ie=e.form)==null?void 0:Ie.style)!=null&&Ce.color&&(jt.value=`${g}label{ color:#${(Ae=(Ne=e.form)==null?void 0:Ne.style)==null?void 0:Ae.color} }`),(Fe=(Ue=e.form)==null?void 0:Ue.fieldStyle)!=null&&Fe.labelColor&&(jt.value=`${g}label{ color:#${e.form.fieldStyle.labelColor} }`),"fieldStyle"in e.form?e.fieldStyle={bgColor:(Ft=(Ct=e==null?void 0:e.form)==null?void 0:Ct.fieldStyle)==null?void 0:Ft.bgColor,labelColor:(Ge=(Et=e==null?void 0:e.form)==null?void 0:Et.fieldStyle)==null?void 0:Ge.labelColor,labelFontFamily:(wt=(Pt=e==null?void 0:e.form)==null?void 0:Pt.fieldStyle)==null?void 0:wt.labelFontFamily,placeholderColor:(Ke=(kt=e==null?void 0:e.form)==null?void 0:kt.fieldStyle)==null?void 0:Ke.placeholderColor,border:(At=(Tt=e==null?void 0:e.form)==null?void 0:Tt.fieldStyle)==null?void 0:At.border,width:(Dt=(Vt=e==null?void 0:e.form)==null?void 0:Vt.fieldStyle)==null?void 0:Dt.width,padding:(Lt=(Le=e==null?void 0:e.form)==null?void 0:Le.fieldStyle)==null?void 0:Lt.padding,shadow:(Ee=(ge=e==null?void 0:e.form)==null?void 0:ge.fieldStyle)==null?void 0:Ee.shadow}:e.fieldStyle=sn,"customStyle"in e.form&&((bo=(Bt=e.form)==null?void 0:Bt.customStyle)==null?void 0:bo.length)>0&&(no.value=e.form.customStyle.replace(".form-element","")),"company"in e.form&&(e.company=(So=e.form)==null?void 0:So.company),"formLabelVisible"in e.form&&(J.value=(Io=e.form)==null?void 0:Io.formLabelVisible);let c=o.calendar||(Co=e.form)==null?void 0:Co.payment;if(!c&&(Fo=o.calendar)!=null&&Fo.stripe&&(((Po=(Eo=o.calendar)==null?void 0:Eo.stripe)==null?void 0:Po.amount)==0||(ko=(wo=o.calendar)==null?void 0:wo.stripe)!=null&&ko.currency)){const Ot={...o.calendar.stripe},to=o.formSubmissionInstruction;Ot.amount=Rr(to==null?void 0:to.isRecurring,to==null?void 0:to.totalRecurringBookings,Ot,o.calendar.enable_charge_guests,((To=o.guests)==null?void 0:To.length)||o.guestCountDetail.count),delete Ot.deposit,delete Ot.depositType,c=Ot}c&&(Re.value={default_payment_provider:c.paymentProvider,publishable_key:c.publishable_key,account_id:c.account_id,amount:(parseFloat(c.amount)*100).toFixed(2),name:c.amount?"Pay to processed":"Verify your card",description:c.charge_description,currency:c.currency}),(Ao=e.form)!=null&&Ao.address&&(we.value=(Vo=e.form)==null?void 0:Vo.address),$e.value=!1,((Lo=(Do=e.form)==null?void 0:Do.payment)==null?void 0:Lo.paymentType)==="product"&&((Ro=(Oo=e.form)==null?void 0:Oo.payment)==null?void 0:Ro.products.length)>0&&await Sn(),((v=(zo=e.form)==null?void 0:zo.payment)==null?void 0:v.paymentType)==="donation"&&((Cr=(Ir=(Sr=e.form)==null?void 0:Sr.payment)==null?void 0:Ir.recurringDonation)!=null&&Cr.isRecurringDonationEnabled)&&e.form.recurringProductId&&(Na.value=await el(e.form.recurringProductId,o.formData.locationId))},he=ni(),ne=_,{$bus:ot}=ii(),We=p([]),go=p([]),Ya=p(!1),Sn=async()=>{var n,s;const t=e.form.payment.products.map(h=>h.productId),r=await ra.getPublicProducts({locationId:o.formData.locationId,productIds:t,includeNonStoreProducts:!0});if(Ya.value=!0,go.value=e.form.payment.products.map(h=>{let g={};return r.products.forEach(c=>{h.productId===c._id&&(g=c)}),g={...g,...h,quantity:1},g}).filter(h=>h._id!==void 0),(s=(n=e.form.payment)==null?void 0:n.bumpSettings)!=null&&s.enableBump){const h=e.form.payment.bumpProducts.map(c=>c.priceId),g=await ra.getSelectedProductPrices({locationId:o.formData.locationId,ids:h==null?void 0:h.join(",")});xa.value=g}};[f,T]=Ri(()=>bn()),await f,T();const In=le(()=>{var r,n,s;const t=(r=o.calendarServiceHelper)==null?void 0:r.state;return!(t!=null&&t.isFormFirst)&&(!(t!=null&&t.isCustomPaymentProvider)||((s=(n=o.calendarServiceHelper)==null?void 0:n.state)==null?void 0:s.usePaymentElementInClassicWidget))&&(t==null?void 0:t.isPaymentEnabled)&&((t==null?void 0:t.isRecurring)&&(t==null?void 0:t.isRecurringSlotLoaded)||!(t!=null&&t.isRecurring))}),Qa=le(()=>I.value.find(t=>t.type==="submit")),Za=le(()=>o.calendar&&o.calendar.enable_guests),Xa=le(()=>o.calendar&&o.calendar.enable_mandatory_guest_type),er=le(()=>o.calendar&&o.calendar.enable_guests&&o.calendar.guest_type==="count_only"),tr=le(()=>{var t;return((t=Re.value)==null?void 0:t.default_payment_provider)==="stripe"}),or=le(()=>{var t;return((t=Re.value)==null?void 0:t.default_payment_provider)==="authorize-net"}),Cn=le(()=>vi.find(t=>t.code===Wt.value)),va=le(()=>Nt.value||Wt.value),ar=le(()=>Object.values(ka));le(()=>{var t,r,n,s,h,g,c;return(((t=o==null?void 0:o.calendar)==null?void 0:t.calendar_type)==="round_robin"||((r=o==null?void 0:o.calendar)==null?void 0:r.calendar_type)==="service_booking"||((n=o==null?void 0:o.calendar)==null?void 0:n.calendar_type)==="personal")&&((h=(s=o==null?void 0:o.calendar)==null?void 0:s.team_members)==null?void 0:h.length)===1?o==null?void 0:o.calendar.team_members[0].location_configurations:((g=o==null?void 0:o.calendar)==null?void 0:g.calendar_type)==="event"?(c=o==null?void 0:o.calendar)==null?void 0:c.location_configurations:null}),le(()=>e.formStyle.border==="0"?"form-top-padding":"");const Fn=(t,r)=>{var n;fo.value=t.length>0,tt.value=t,Yt.value=r,e.formFieldsValue.payment=(tl((n=tt.value[0])==null?void 0:n.currency)||"$")+r.summary.total},En=t=>{Zo.value=t},Pn=le(()=>{var t,r,n,s,h,g,c,x,H,K,m;return(r=(t=I.value.filter(u=>u.hiddenFieldQueryKey==="payment"))==null?void 0:t[0])!=null&&r.hidden?!1:((s=(n=e.form)==null?void 0:n.payment)==null?void 0:s.paymentType)===Je.PRODUCT?((g=(h=e.form)==null?void 0:h.payment)==null?void 0:g.required)&&((H=(x=(c=e.form)==null?void 0:c.payment)==null?void 0:x.products)==null?void 0:H.length)||fo.value:((m=(K=e.form)==null?void 0:K.payment)==null?void 0:m.required)||uo.value});xr({__dangerouslyDisableSanitizers:["style"],style:[{children:lo.value,type:"text/css"},{children:so.value,type:"text/css"},{children:jt.value,type:"text/css"},{children:no.value,type:"text/css"},{children:Ua.value,type:"text/css"}],meta:[{name:"apple-mobile-web-app-capable",content:"yes"},{name:"viewport",content:"minimum-scale=1.0, width=device-width, maximum-scale=1, user-scalable=no"}]});let rr=!1;setTimeout(()=>{Mo(o.urlParams,F,e.phoneCountryIncluded,M.value,e.formFieldsValue,I.value,we.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,M.value=t.formattedCountry,I.value=t.formFields})},Pa()?1e3:100);const nr=p("");I.value.filter(t=>{var r,n;return!kr((n=(r=o.formData)==null?void 0:r.form)==null?void 0:n.fields,t)}).forEach((t,r)=>{nr.value+=yn(t,r)}),I.value.forEach((t,r)=>{if(t.type==="textbox_list"){const n={};t.picklistOptions.forEach(s=>{n[s.id]=s.prefillValue}),e.formFieldsValue[t.tag]=n}else t.type==="source"?e.formFieldsValue[t.tag]=t.value:t.type==="checkbox"&&!(e.formFieldsValue[t.tag]instanceof Array)?e.formFieldsValue[t.tag]=[]:t.type==="submit"&&(rr=!0,o.calendar&&(t.label&&t.label.toLowerCase()==="button"||t.label.trim().length<=0)&&(t.label=o.calendarConfirmationButtonText?o.calendarConfirmationButtonText:A(o.forCalendarV3?"schedule_meeting":"book_appointment")))}),rr||I.value.push({label:o.calendarConfirmationButtonText?o.calendarConfirmationButtonText:o.calendar?A(o.forCalendarV3?"schedule_meeting":"book_appointment"):A("submit"),tag:"button",palceholder:"button",type:"submit"}),I.value.length>0&&I.value.forEach((t,r)=>{if(t.type==="html"&&t&&"html"in t){const n=t.html.replace(/[‘’]/g,"'").replace(/[""]/g,'"');Jo.value.push({scriptString:n,index:r})}}),Oe.value=Math.random().toString(36).slice(2),o.urlParams&&Mo(o.urlParams,F,e.phoneCountryIncluded,M.value,e.formFieldsValue,I.value,we.value).then(t=>{e.phoneCountryIncluded=t.phoneCountryIncluded,e.formFieldsValue=t.formFieldsValue,M.value=t.formattedCountry,I.value=t.formFields,setTimeout(()=>ba(),1e3)});const ir=p(Date.now()),lr=p(!1),_a=async(t,r)=>{var n;try{if(F.query.notrack)return;if(!lr.value){lr.value=!0;let s=(r==null?void 0:r.id)||(r==null?void 0:r.tag)||(r==null?void 0:r.label),h=r==null?void 0:r.type;if((r==null?void 0:r.tag)==="group_address"&&(t!=null&&t.target)){const c=t.target.name||t.target.getAttribute("data-field-name");c&&(s=c,h="address_field")}const g=zr(ir.value);Ia({fingerprint:$t((n=o==null?void 0:o.formData)==null?void 0:n.locationId),eventType:"form-start-conversion",mediumId:o.formId,medium:"form",locationId:o.formData.locationId,name:o.formData.name,fieldId:s,firstFocusAt:Date.now(),focusedFieldId:s,focusedFieldType:h,focusedLoadDuration:g.loadTime}).catch(c=>{console.error("handleFieldFocus API call error:",c)})}}catch(s){console.error("handleFieldFocus error:",s)}};Fr(async()=>{var h,g,c,x,H,K;o.calendar&&ot.$on("submitCalendarForm",Mt),o.isCalendarService&&ot.$on("submitCalendarServiceForm",Mt);try{await al()}catch(m){console.error("Failed to load reCAPTCHA script",m)}!o.funnelPreview&&Ut.value!==void 0&&Ut.value!==""&&ta(()=>{Ni(Ut.value,e.form.pageViewEvent)}),Jn();const t=F.query.payment_intent,r=F.query.transactionId;t&&!((h=o.calendar)!=null&&h.id)&&!o.isCalendarService&&(po.value=!0,await Ar(t,o.formId||"",r)?await pr():(sessionStorage.removeItem(`submissionResponse-${o.formId}`),sessionStorage.removeItem(`formOrderResponse-${o.formId}`)),po.value=!1);const n=F.query.setup_intent;if(n&&!((g=o.calendar)!=null&&g.id)&&!o.isCalendarService&&(po.value=!0,await Ar(t,o.formId||"",r,n)?await pr():(sessionStorage.removeItem(`submissionResponse-${o.formId}`),sessionStorage.removeItem(`formOrderResponse-${o.formId}`)),po.value=!1),Qe.value&&(We.value=I.value.map(m=>m.tag),Ta(void 0,z.value,We.value,e.formFieldsValue,e.phoneCountryIncluded,M.value,we.value).then(m=>{m?(e.formFieldsValue=m.formFieldsValue,e.phoneCountryIncluded=m.phoneCountryIncluded,M.value=m.formattedCountry):console.warn("Data not found! skippping stickycontact fill")}).catch(m=>{console.error("Failed at fillDataFromCookie",m)})),F.query.hasOwnProperty("sticky_contact_help")&&F.query.sticky_contact_help==="true"&&(console.log("%c Sticky Contact data","color: black; font-weight: bold; background-color: white"),console.log("%c ===================","color: black; font-weight: bold; background-color: white"),console.log(JSON.parse(Er("_ud"))),console.log("%c ===================","color: black; font-weight: bold; background-color: white")),ta(()=>{var m;if(zt.value=!0,!F.query.notrack){const u=zr(ir.value);Ia({fingerprint:$t((m=o==null?void 0:o.formData)==null?void 0:m.locationId),eventType:"form-load-time",mediumId:o.formId,medium:"form",locationId:o.formData.locationId,name:o.formData.name,timeSpent:u.loadTime,startTimestamp:u.startTimestamp,endTimestamp:u.endTimestamp,totalBlockingTime:u.totalBlockingTime,firstContentfulPaint:u.firstContentfulPaint,timeToInteractive:u.timeToInteractive,networkType:u.networkType,cacheStatus:u.cacheStatus,cdnStatus:u.cdnStatus,pageSizeKB:u.pageSizeKB}).catch(oe=>{console.error("form-load-time API call error:",oe)})}}),o.calendar&&o.locale!=="en"&&o.locale!=="en_US"){window.dayjs=fe;const m=Or(o.locale);await li(`unpkg.com/dayjs@1.8.21/locale/${m}.js`,()=>{fe.locale(m)})}if(o.stickyContactData&&Qe.value&&(We.value||(We.value=I.value.map(m=>m.tag)),Ta(o.stickyContactData,z.value,We.value,e.formFieldsValue,e.phoneCountryIncluded,M.value,we.value).then(m=>{e.formFieldsValue=m.formFieldsValue,e.phoneCountryIncluded=m.phoneCountryIncluded,M.value=m.formattedCountry}).catch(m=>{console.error("Failed at fillDataFromCookie at sticky contact",m)})),la.value=!0,ja.value=new Date().getTime(),!F.query.notrack){let m=$t((c=o==null?void 0:o.formData)==null?void 0:c.locationId);m||(m=$r(),qo((x=o==null?void 0:o.formData)==null?void 0:x.locationId,m));const u=await Ia({fingerprint:m,eventType:"form-view",mediumId:o.formId,medium:"form",locationId:o.formData.locationId,name:o.formData.name}),oe=Uo(u,ie=>{m!==ie.fingerprint&&(m=ie.fingerprint),oe()})}setTimeout(()=>{ba(),mr(e.formFieldsValue),Ra.value=!0},100);const s=JSON.parse(localStorage.getItem("_ud")||"{}");if(he.value.formAction==="thankYouPage"&&e.form.formAction.actionType==="2"){Ve.value=!0;const m=e.form.formAction.thankyouText?Ca(e.form.formAction.thankyouText,s):"Thanks for submiting details, Will get back to you soon!";Pe.value={action:"submit-form",message:m,style:e.form.submitMessageStyle,isFormPosted:Ve.value,height:(K=(H=o.formData)==null?void 0:H.form)==null?void 0:K.height}}if(he.value.formAction==="orderConfirmationPage"&&e.form.formAction.actionType==="3"){const m=JSON.parse(sessionStorage.getItem(`formData-${o.formId}`)||"null");m&&(ye.value=m.productPurchased,tt.value=m.productPurchasedList,Yt.value=m.productSummary,Zo.value=m.couponCode,ye.value&&tt.value.length&&(Ve.value=!0,Pe.value={action:"order",style:{width:e.form.width,style:e.form.style,fieldStyle:e.form.fieldStyle},productPurchased:tt.value.map(u=>(go.value.forEach(oe=>{oe._id===u.productId&&(u.showImage=oe.showImage,u.showDescription=oe.showDescription)}),u)),orderId:ye.value.orderId,productSummary:Yt.value,couponCode:Zo.value,contact:s}))}}),si(()=>{B.value=[]}),Uo(()=>o.urlParams,(t,r)=>{o.urlParams&&Mo(o.urlParams,F,e.phoneCountryIncluded,M.value,e.formFieldsValue,I.value,we.value).then(n=>{e.phoneCountryIncluded=n.phoneCountryIncluded,e.formFieldsValue=n.formFieldsValue,M.value=n.formattedCountry,I.value=n.formFields})}),Uo(()=>o.stickyContactData,(t,r)=>{o.stickyContactData&&Qe.value&&(We.value||(We.value=I.value.map(n=>n.tag)),Ta(o.stickyContactData,z.value,We.value,e.formFieldsValue,e.phoneCountryIncluded,M.value,we.value).then(n=>{e.formFieldsValue=n.formFieldsValue,e.phoneCountryIncluded=n.phoneCountryIncluded,M.value=n.formattedCountry}).catch(n=>{console.error("Failed at fillDataFromCookie at sticky contact",n)}))}),p({}),Uo(()=>e.formFieldsValue,()=>{ea(e.formFieldsValue,!0),mr(e.formFieldsValue)},{deep:!0}),Uo(()=>{var t;return[(t=o.guestCountDetail)==null?void 0:t.count,o.guests]},()=>{var t;o.calendarServiceHelper.state&&(o.calendarServiceHelper.state.guestCount=((t=o.guestCountDetail)==null?void 0:t.count)||0,o.calendarServiceHelper.state.guests=o.guests||[])},{deep:!0});const sr=t=>{Nt.value=t},wn=t=>{e.formFieldsValue.captchaToken=void 0,e.validationError=t},kn=t=>{y.value=t},Tn=t=>{U.value=t},An=(t,r,n)=>{sa.value=t&&t.length?t.replace(/\s/g,""):null,r&&r.length&&r.includes("/")&&(r=r.split("/"),da.value=r[0],ca.value=r[1]),Qo.value=n},Vn=t=>{He.value=t},eo=t=>{const{tag:r,value:n}=t;e.formFieldsValue[r]=n},dr=t=>{M.value=t,Vr(e.formFieldsValue,M.value),ea({...e.formFieldsValue,country:t},!0)},Dn=t=>{Yo.value=t},te=t=>{const{tag:r,error:n}=t;e.errors[r]=n,Ln(t),cr()},Ln=t=>{const{tag:r,error:n}=t;if(r=="email"&&o.guests.length>=1){const s=[e.formFieldsValue[r]];o.guests.forEach(h=>{s.includes(h.email)?(h.emailError="Email IDs must be unique for guests.",h.invalidEmail=!0):(h.emailError="",h.invalidEmail=!1),s.push(h.email)})}},On=t=>{ia.value=t,e.formFieldsValue.captchaToken=t},Rn=t=>{const{date:r,item:n}=t;e.formFieldsValue[n.tag]=r},Xo=t=>{const r=e.phoneCountryIncluded[t.tag],n=e.phoneCountryCode[t.tag];e.formFieldsValue[t.tag]=r,t.tag==="phone"&&(Ye.value=e.formFieldsValue[t.tag]);try{const s=window.libphonenumber.parsePhoneNumberFromString(r,n);t.tag==="phone"&&(Ye.value=s.isValid()?s.number:r),e.phoneCountryIncluded[t.tag]=s.isValid()?s.number:r,e.phoneCountryCode[t.tag]=s.country?s.country:n,e.formattedPhone[t.tag]=s.isValid()?s.formatNational():r}catch{e.phoneCountryIncluded[t.tag]=r,e.formattedPhone[t.tag]=r}},zn=()=>{let t=!1,r=0;return I.value.map(n=>{n.type==="cascade_dropdown"&&n.required&&e.formFieldsValue[n.tag]===void 0?(Gt.value=!1,t=!0):e.formFieldsValue[n.tag]!==void 0&&n.type==="cascade_dropdown"&&(e.formFieldsValue[n.tag].forEach(function(h){for(const g in h)h[g]===""&&r++}),r>0?(Gt.value=!1,t=!0):Gt.value=!0)}),t},Nn=async t=>{const r=B.value.map(s=>{if(s!=null&&s.validate)return s.validate(t)});return await Promise.all(r),await cr()},Un=async()=>{let t=!1;const r=B.value.map(n=>{var s;((s=n==null?void 0:n.item)==null?void 0:s.type)==="captcha"&&(t=!0)});return await Promise.all(r),t},cr=async()=>{const t=Object.values(e.errors);let r=!1;return await Promise.all(t.map(n=>{n&&(r=!0)})),r},vo=t=>{var n;return t===I.value.length-1||Ea.indexOf((n=I.value[t+1])==null?void 0:n.type)>=0?ur(t):!0},ur=t=>xn(t)%2===0,xn=t=>{let r=0;for(let n=t;n>=0;n--)if(Ea.indexOf(I.value[n].type)===-1)r+=1;else return r;return r},Mn=t=>{e.formFieldsValue[t.tag]=""},Bn=t=>{const{item:r,event:n}=t;e.formFieldsValue[r.tag]=n.target.value},qn=t=>{for(const r of I.value)if(r.hiddenFieldQueryKey===t&&(r.Id||r.id))return r.Id||r.id;return null},ea=(t,r=!1)=>{var c,x,H,K,m,u,oe,ie,se,de,ce,ee,ue,Y,D,q,W,R;const n={...t};if(M.value&&r&&(n.country=M.value),n!=null&&n.phone&&r){const C=(x=(c=window.libphonenumber)==null?void 0:c.parsePhoneNumberFromString(t.phone,e.phoneCountryCode.phone))==null?void 0:x.number;C&&(n.phone=C)}try{const C=Array.isArray(I.value)?I.value:[],S=Pi(C,e.formFieldsValue);Object.assign(n,S)}catch{}if(!((H=e.form)!=null&&H.conditionalLogic)||!((K=e.form.conditionalLogic)!=null&&K.length))return;const s=new Set,h=new Set,g=(u=(m=e.form)==null?void 0:m.conditionalLogic)==null?void 0:u.filter(C=>{var S,$;return r?((S=C==null?void 0:C.outcome)==null?void 0:S.type)==="showHideFields":C.conditions!==null&&(($=C==null?void 0:C.outcome)==null?void 0:$.type)!=="showHideFields"});for(let C=0;C<g.length;C++){const S=g[C];let $=S.conditionalOperation==="and";const me={...n};for(let re=0;re<S.conditions.length;re++){let{selectedField:Q,selectedOperation:ae,inputValue:De}=S.conditions[re];const ke=S.conditions[re].selectedField;Q==="country"&&!r&&ka[me[Q]]&&(me[Q]=ka[me[Q]]);const Te=qn(Q);Te!==null&&(Q=Te);const Ze=me[Q],je=wi(ae,ke,Ze,De,I.value);if(S.conditionalOperation==="and"&&!je){$=!1;break}if((S.conditionalOperation==="or"||S.conditionalOperation==="then")&&je){$=!0;break}}if(((oe=S.outcome)==null?void 0:oe.type)==="showHideFields"&&r&&$){const{hideType:re,value:Q}=S.outcome,ae=Array.isArray(Q)?Q:[Q],De=ke=>Vi(I.value,ke);ae.forEach(ke=>{const Te=ki(ke,De);re.includes("Show")?s.add(Te):re.includes("Hide")&&h.add(Te)})}if($){if(((ie=S.outcome)==null?void 0:ie.type)==="displayCustomMessage"||((se=S.outcome)==null?void 0:se.type)==="disqualifyLead"&&((de=S.outcome)==null?void 0:de.disqualifyAction)==="showCustomMessage"?(e.form.formAction.actionType="2",e.form.formAction.thankyouText=S.outcome.value):(((ce=S.outcome)==null?void 0:ce.type)==="redirectToUrl"||((ee=S.outcome)==null?void 0:ee.type)==="disqualifyLead"&&((ue=S.outcome)==null?void 0:ue.disqualifyAction)==="openUrl")&&(e.form.formAction.actionType="1",e.form.formAction.redirectUrl=S.outcome.value,e.form.formAction.redirect_url=S.outcome.value),((Y=S.outcome)==null?void 0:Y.type)==="disqualifyLead"&&(e.form.disqualified=!0),!r)break}else((q=(D=e.form)==null?void 0:D.payment)!=null&&q.required||uo.value||fo.value)&&!((R=(W=I.value)==null?void 0:W.find(re=>re.hiddenFieldQueryKey==="payment"))!=null&&R.hidden)&&(e.form.formAction.actionType=o.formData.form.formAction.actionType,e.form.formAction.thankyouText=o.formData.form.formAction.thankyouText,e.form.formAction.redirectUrl=o.formData.form.formAction.redirectUrl,e.form.disqualified=void 0)}s.forEach(C=>h.delete(C)),ya.value&&(I.value=ya.value),I.value=I.value.map(C=>{if(s.has(C.hiddenFieldQueryKey)){const S=o.formData.form.fields.find($=>$.hiddenFieldQueryKey===C.hiddenFieldQueryKey);return{...C,hidden:!1,hiddenFieldValue:(S==null?void 0:S.hiddenFieldValue)||"",required:(S==null?void 0:S.required)||!1}}else if(h.has(C.hiddenFieldQueryKey))return{...C,hidden:!0,required:!1};return C}),setTimeout(()=>{Mo(o.urlParams,F,e.phoneCountryIncluded,M.value,e.formFieldsValue,I.value,we.value,!0).then(C=>{e.phoneCountryIncluded=C.phoneCountryIncluded,e.formFieldsValue=C.formFieldsValue,M.value=C.formattedCountry,I.value=C.formFields})},1e3)},mr=t=>{xi(e.form,I.value,t).forEach(({hiddenFieldQueryKey:n,result:s})=>{e.formFieldsValue[n]=s})},ba=()=>{var s,h;setTimeout(()=>ea(e.formFieldsValue,!0),0);const t=(h=(s=e.form)==null?void 0:s.conditionalLogic)==null?void 0:h.filter(g=>{var c;return((c=g==null?void 0:g.outcome)==null?void 0:c.type)==="showHideFields"});let r=[],n=[];t&&(t.forEach(g=>{if(g.outcome.type==="showHideFields"){const{hideType:c,value:x}=g.outcome,H=Array.isArray(x)?x:[x];c.includes("Show")?(r=[...new Set([...r,...H])],n=n.filter(K=>!H.includes(K))):c.includes("Hide")&&(n=[...new Set([...n,...H])],r=r.filter(K=>!H.includes(K)))}}),I.value.forEach(g=>{r.includes(g.hiddenFieldQueryKey)?(g.hidden=!0,g.required=!1,g.hiddenFieldValue=""):n.includes(g.hiddenFieldQueryKey)&&(g.hidden=!1,g.hiddenFieldValue="")}),ya.value=Mr(I.value))},$n=async()=>(await Vr(e.formFieldsValue,M.value),(await qi(F,I.value,e.formFieldsValue)).formFieldsValue),Mt=async(t,r)=>{var H,K,m,u,oe,ie,se,de,ce,ee,ue,Y,D,q;let n=o.formSubmissionInstruction;if(n.isRecurring=(n==null?void 0:n.isRecurring)??((H=o.calendar)==null?void 0:H.enable_recurring),He.value){_o(He.value);return}for(let W in e.phoneCountryIncluded)e.phoneCountryIncluded[W]&&Xo({tag:W});if(await Mi(e.formFieldsValue)>di){alert("The total size of the attached files cannot be more that 50MB"),_o(!0);return}e.validationError={};const h=await Nn(r);let g=!0;if((K=o.calendarMeetingLocationDetails)!=null&&K.validateMeetingLocation&&(g=(m=o.calendarMeetingLocationDetails)==null?void 0:m.validateMeetingLocation()),h||zn()||!g){_o(h),setTimeout(()=>{Br(e,I.value,o.formId)},100);return}if(await Un()&&(Yo.value===void 0||Yo.value==="0")){e.validationError.captcha="Invalid Captcha",_o(!0),setTimeout(()=>{Br(e,I.value,o.formId)},100);return}let x;if(ne("disableBackOnSubmit",{disable:!0}),pe.value=!0,He.value="",!((oe=(u=o.calendarServiceHelper)==null?void 0:u.state)!=null&&oe.isFormFirst)&&!((se=(ie=o.calendarServiceHelper)==null?void 0:ie.state)!=null&&se.isCustomPaymentProvider)&&((ce=(de=o.calendarServiceHelper)==null?void 0:de.state)!=null&&ce.isPaymentEnabled)&&!await((ee=o.calendarServiceHelper)==null?void 0:ee.newCardPaymentElementRef.value.validatePayment()))return ne("disableBackOnSubmit",{disable:!1}),pe.value=!1,_o(!0),setTimeout(()=>{const R=document.querySelector(".payment-block");R&&R.scrollIntoView({behavior:"smooth",block:"center"})},100),!1;if(!(n!=null&&n.onlySubmitForm)&&!(n!=null&&n.shouldPayUsingPaymentElement)){if(tr.value&&Re.value&&!et.value){x={};try{const W=n.isRecurring,R=n.totalRecurringBookings,{client_secret:C}=await $fetch(X.public.serverBaseUrl+"/appointment/setup-intent",{method:"POST",body:{locationId:o.formData.locationId,calendarId:o.calendar.id}});if(!C)throw He.value="Something went wrong while processing your payment, please try again.",new Error("clientSecret missing");let S,$;if(e.formFieldsValue.first_name&&($=e.formFieldsValue.first_name.trim()),e.formFieldsValue.full_name&&($=e.formFieldsValue.full_name.trim()),S=await y.value.confirmCardSetup(C,{payment_method:{card:U.value,billing_details:$?{name:$}:{}}},{handleActions:!1}),S.error)throw He.value=S.error.message,S.error;{const me={...e.formFieldsValue};if(Qe.value){let ae;if(typeof Storage<"u")try{ae=Er(z.value)}catch{console.error("Failed to fetch contact from local storage")}ae||(ae=Xe(z.value).value||Xe("msgsndr_id").value),ae&&(me.contact_id=ae)}Ye.value&&(me.phone=Ye.value);const re={location_id:z.value,calendar_id:o.calendar.id,payment_method_id:S.setupIntent.payment_method,setup_intent_status:S.setupIntent.status,customer_data:me,...W?{totalRecurringBookings:R}:{}},Q=await $fetch(X.public.serverBaseUrl+"/appointment/setup-stripe-customer-and-payment-intent",{method:"POST",body:re});if(Q.status==="requires_action"){const ae=await y.value.handleCardAction(Q.client_secret);if(ae.error)throw He.value=ae.error.message,ae.error;x.payment_intent_id=ae.paymentIntent.id}else x.payment_intent_id=Q.id;x.stripe_customer_id=Q.stripe_customer_id}}catch(W){return console.error(W),He.value||(He.value="Something went wrong while processing your payment, please try again."),ne("disableBackOnSubmit",{disable:!1}),pe.value=!1,!1}}else if(or.value&&Re.value){x={};let W=!1;if(sa.value||($a(!0),W=!0),(!da.value||!ca.value)&&(Ha(!0),W=!0),Qo.value||(Wa(!0),W=!0),W||Ma.value||Ba.value||qa.value)return;pa(""),rn();try{const{publishable_key:R,account_id:C}=Re.value,S={authData:{clientKey:R,apiLoginID:C},cardData:{cardNumber:sa.value,month:da.value,year:ca.value,cardCode:Qo.value}},$=await on(S);x={opaqueData:$==null?void 0:$.opaqueData,cardCode:Qo.value}}catch(R){if(R.type==="authorizeNetServerError"){pa((q=(D=(Y=(ue=R==null?void 0:R.response)==null?void 0:ue.messages)==null?void 0:Y.message)==null?void 0:D[0])==null?void 0:q.text);return}pa((R==null?void 0:R.message)||"Something went wrong!")}}}e.formFieldsValue=await $n(),await Gn(x,n,t,r),ne("disableBackOnSubmit",{disable:!0})},Hn=t=>{const r={};for(const n in t)t.hasOwnProperty(n)&&(r[n.replace(/(\_\w)/g,function(s){return s[1].toUpperCase()})]=t[n]);return r},Wn=o.formId===((gr=he.value.webinarProperties)==null?void 0:gr.formId),jn=((vr=he.value.webinarSession)==null?void 0:vr.sessionEnd)&&fe(he.value.webinarSession.sessionEnd).isAfter(fe()),at=Wn&&jn?he.value.webinarSession:null,Gn=async(t,r,n,s)=>{var ce,ee,ue,Y,D,q,W,R,C,S,$,me,re,Q,ae,De,ke,Te,Ze,je,rt,nt,d,V,ze,it,lt,st,dt,ct,ut,mt,ft,pt,yt,ht,gt,vt,_t,bt,St,It;const h=Xe("msgsndr_id").value;if(o.formId&&(e.formFieldsValue.formId=o.formId),e.formFieldsValue.location_id=z.value,Ye.value&&(e.formFieldsValue.phone=Ye.value),Qe.value){let b;if(o.stickyContactFingerprint&&(b=o.stickyContactFingerprint),!b&&typeof Storage<"u")try{b=Hr(z.value)}catch{console.error("Failed to get contact from local storage")}b||(b=Xe(z.value).value||h),b&&(e.formFieldsValue.contact_id=b)}const g=F.query.contact_id||((ce=o.urlParams)==null?void 0:ce.contact_id);g&&(e.formFieldsValue.query_contact_id=g);const c=e.formFieldsValue;co.value=null,(ee=o.calendar)!=null&&ee.form_submit_type?o.calendar.form_submit_type==="RedirectURL"&&(co.value=o.calendar.form_submit_redirect_url||o.calendar.thank_you_url):((D=(Y=(ue=o.calendar)==null?void 0:ue.thank_you_url)==null?void 0:Y.trim())==null?void 0:D.length)>0&&(co.value=(q=o.calendar)==null?void 0:q.thank_you_url),o.event?c.event_id=F.query.event_id:o.calendarEventId&&(c.event_id=o.calendarEventId),o.guests.length?c.guests=o.guests.map(({name:b,email:E})=>({name:b,email:E})):o.guestCountDetail.count&&(c.guestCount=o.guestCountDetail.count),o.calendar&&(c.calendar_id=o.calendar.id,r!=null&&r.onlySubmitForm||(c.selected_slot=(W=o.selectedSlot)==null?void 0:W.format(),c.selected_timezone=o.timezone,o.calendarMeetingLocationDetails.meetingLocationId&&(c.meeting_location_id=o.calendarMeetingLocationDetails.meetingLocationId),o.calendarMeetingLocationDetails.bookerMeetingLocation&&(c.booker_meeting_location=o.calendarMeetingLocationDetails.bookerMeetingLocation))),r!=null&&r.onlySubmitForm||(et.value?c.stripeToken=et.value:t&&(c.stripePaymentResult=t));const x=Oa(c.locationId);x&&(c.sessionId=x),(o.calendar||o.isCalendarService)&&Wi(((R=o.calendar)==null?void 0:R.id)||z.value,c),Jt.value=zi(),c.eventData={...Gr(o.pageUrl,o.baseReferrrer),fbEventId:Jt.value};let H=$t(c.locationId);if(H&&(c.sessionFingerprint=H),o.funnelPreview){let{domain:b,page_url:E}=F.query;b||(b=window.location.hostname,E=window.location.pathname),c.funneEventData={event_type:"optin",domain_name:b,page_url:E,funnel_id:he.value.funnelId,page_id:he.value.funnelPageId,funnel_step_id:he.value.stepId},at!=null&&at._id&&(c.funneEventData.webinar_session_id=at._id)}ia.value&&(c.captchaToken=ia.value);let K=X.public.REST_API_URLS+`/forms/submit?formId=${o.formId}&locationId=${z.value}`;if(o.calendar){if(o.isNewCalendarWidgetEnabled){const b=o.formElementClass?"booking-"+o.formElementClass:"calendar-"+((C=o.calendar)==null?void 0:C.id),E=document.querySelector(`.${b}`);E&&E.scrollIntoView({behavior:"smooth"})}r.onlySubmitForm||(K=X.public.newBaseURL+"/appointment"),Qn(c)}let m=new FormData,u={};Object.keys(c).forEach(async b=>{var E;if(c[b]instanceof File)m.append(b,c[b]);else if((E=c[b])!=null&&E.files){const k=Object.values(c[b].files);k.length&&await Promise.all(k.map(L=>{m.append(b,L)}))}else(c[b]||c[b]===0)&&(u[b]=c[b])}),F.query.user_id&&(u.user_id=F.query.user_id);const ie=Xe("am_id").value,se=Xe("sam_id").value,de=Xe("am_fingerprint").value;if(ie&&(u.amId=ie),de&&(u.amFingerprint=de),se&&(u.samId=se),o.calendar){if(u.eventData.medium=wa.Calendar,u.eventData.mediumId=u==null?void 0:u.calendar_id,o.formId){let b=I.value.filter(E=>E.type==="date");u.dateFieldDetails=b}}else u.eventData.medium=o.isCalendarService?wa.Calendar:wa.Form,u.eventData.mediumId=o.isCalendarService?z.value:u==null?void 0:u.formId;if(e.form.isLeadGenVideo&&(u.internalSource={type:"hosted_video"}),e.form.enableTimezone!==!1&&(u.Timezone=`${ci()} ${ui()}`),mo.value&&(u.submissionId=mo.value),ua.value&&(u.paymentContactId=ua.value),(uo.value||fo.value)&&(u.paymentStatus="Pending"),r!=null&&r.shouldPayUsingPaymentElement&&(u.payment_meta={status:"pending"}),F.query.notrack||(u.timeSpent=(new Date().getTime()-ja.value)/1e3),($=(S=I.value)==null?void 0:S.find(b=>b.hiddenFieldQueryKey==="payment"))!=null&&$.hidden&&(delete u.payment,delete u.paymentStatus,delete u.paymentContactId),r.onlySubmitForm&&(u.internalSource={type:"calendar",id:(me=o.calendar)==null?void 0:me.id},u.source=((re=o.calendar)==null?void 0:re.name)||((Q=o.calendar)==null?void 0:Q.id),u.calendar_name=(ae=o.calendar)==null?void 0:ae.name,(De=o.calendar)!=null&&De.stripe&&(((Te=(ke=o.calendar)==null?void 0:ke.stripe)==null?void 0:Te.amount)==0||(je=(Ze=o.calendar)==null?void 0:Ze.stripe)!=null&&je.currency))){const b={...o.calendar.stripe};u.payment=Rr(r==null?void 0:r.isRecurring,r==null?void 0:r.totalRecurringBookings,b,o.calendar.enable_charge_guests,((rt=o.guests)==null?void 0:rt.length)||o.guestCountDetail.count,((V=(d=(nt=o.calendarServiceHelper)==null?void 0:nt.state)==null?void 0:d.coupon)==null?void 0:V.discountAmount)||0)}if(r.onlySubmitForm||!(r!=null&&r.isRecurring)){if(o.calendar||ea(c),o.isCalendarService&&(u.internalSource={type:"calendar",id:z.value},u.source="service_booking"),o.calendar&&((ze=o.calendarServiceHelper.state)!=null&&ze.coupon)&&(u.coupon={code:(lt=(it=o.calendarServiceHelper.state)==null?void 0:it.coupon)==null?void 0:lt.couponCode,chargeNow:(dt=(st=o.calendarServiceHelper.state)==null?void 0:st.coupon)==null?void 0:dt.chargeNow}),u.disqualified=e.form.disqualified,m.set("formData",JSON.stringify(u)),m.append("locationId",z.value),o.formId&&m.append("formId",o.formId),Xt.value&&m.append("captchaToken",Xt.value),m.append("captchaV3",await Nr(Ur.LEADGEN_FORM_SUBMIT)),o.isCalendarService){ne("onFormSubmitCallback",{formSubmissionData:u,formData:m,isError:!1});return}const b={},E=(ut=(ct=Intl==null?void 0:Intl.DateTimeFormat())==null?void 0:ct.resolvedOptions())==null?void 0:ut.timeZone;E&&(b.timezone=E),P(b),$fetch(K,{method:"POST",body:m,headers:b}).then(async k=>{var L;ho(),$t((L=o==null?void 0:o.formData)==null?void 0:L.locationId),ma.value=k,ua.value=k.contactId,mo.value=k.submissionId,sessionStorage.setItem(`submissionResponse-${o.formId}`,JSON.stringify(ma.value)),sessionStorage.setItem(`formData-${o.formId}`,JSON.stringify({phoneCountryIncluded:e.phoneCountryIncluded,formattedCountry:M.value,formFieldsValue:e.formFieldsValue,formFields:I.value,productPurchased:ye.value,productPurchasedList:tt.value,productSummary:Yt.value,submissionId:mo.value})),!o.calendar&&Pn.value?await za.value.processPayment(k.contactId,k.fingerprint,k.contact,n,s):(await Sa(k),r.onlySubmitForm||(k.formData=u),na(),ne("onFormSubmitCallback",{formSubmissionData:k})),at!=null&&at._id&&rl(he.value.funnelId,{...at,fingerprint:k.fingerprint})}).catch(k=>{var L,_e,be,Se,Ie,Ce,Ne,Ae,Ue;if([429].includes(k.status)?Zt.value=!0:ho(),console.error("error",k),pe.value=!1,ne("onFormSubmitCallback",o.isCalendarService?{isLoading:!1}:{loadingScreen:{showLoadingScreen:!1}}),o.calendar){let Fe="";((L=k==null?void 0:k.response)==null?void 0:L.status)===502?Fe=((be=(_e=k==null?void 0:k.response)==null?void 0:_e._data)==null?void 0:be.message)||((Ie=(Se=k==null?void 0:k.response)==null?void 0:Se.data)==null?void 0:Ie.msg)||"Something went wrong with your payment. Please try again.":(Fe=((Ne=(Ce=k==null?void 0:k.response)==null?void 0:Ce._data)==null?void 0:Ne.message)||((Ue=(Ae=k==null?void 0:k.response)==null?void 0:Ae.data)==null?void 0:Ue.msg)||A("unable_to_schedule_appointment"),Fe=Fe||"unable_to_schedule_appointment"),ne("processError",{error:Fe})}})}else try{u.source=(mt=o.calendar)==null?void 0:mt.name,u.channel="private_api",u.calendar_name=(ft=o.calendar)==null?void 0:ft.name,u.internalSource={type:"calendar",id:(pt=o.calendar)==null?void 0:pt.id},m.set("formData",JSON.stringify(u)),m.append("locationId",z.value),(yt=o.calendar)!=null&&yt.id&&m.append("calendarId",(ht=o.calendar)==null?void 0:ht.id),Xt.value&&m.append("captchaToken",Xt.value),m.append("captchaV3",await Nr(Ur.LEADGEN_FORM_SUBMIT));const b={};$fetch(X.public.REST_API_URLS+"/forms/submit",{method:"POST",body:m,headers:b,params:{formId:o.formId,locationId:z.value}}).then(async E=>{var _e,be,Se,Ie,Ce,Ne,Ae,Ue,Fe,Ct,Ft,Et,Ge,Pt,wt,kt,Ke,Tt,At,Vt;ho();const k={...u,contact:{id:(_e=E.contact)==null?void 0:_e.id},source:"booking_widget",formSubmissionId:E==null?void 0:E.submissionId,isNewContact:E==null?void 0:E.contact.isNew,skipFormSubmit:!0,...o.calendar&&((be=o.calendarServiceHelper.state)==null?void 0:be.coupon)&&{coupon:{code:(Ie=(Se=o.calendarServiceHelper.state)==null?void 0:Se.coupon)==null?void 0:Ie.couponCode,chargeNow:(Ne=(Ce=o.calendarServiceHelper.state)==null?void 0:Ce.coupon)==null?void 0:Ne.chargeNow}}};(Ue=(Ae=o.calendarServiceHelper)==null?void 0:Ae.setCustomState)==null||Ue.call(Ae,{showLoadingScreen:!0}),Object.keys(o.calendarServiceHelper).length>0&&((Fe=o.calendarServiceHelper)==null||Fe.setFormSubmissionData(E));const L=await Me.createRecurringEvents(Hn(k));if(L.ids&&L.ids.length){let Dt,Le=L.fingerprint,Lt=L.sessionFingerprint,ge={};try{o.calendar&&(Dt=e.formFieldsValue,Le=(L==null?void 0:L.fingerprint)||((Ct=L==null?void 0:L.contact)==null?void 0:Ct.fingerprint)||L.contactId);const Ee="_ud";ge=await aa(L.contact,!0),o.calendar&&(ge={...ge,appointment:L.appointment}),Bo(Ee,JSON.stringify(ge)),Da(z.value,Le),window.parent.postMessage(["set-sticky-contacts",Ee,JSON.stringify(ge),z.value,Le],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${o.iFrameId}`,o.iFrameId,z.value,Le],"*"),o.event||(La({sessionId:L.sessionId||null,locationId:z.value}),Lt&&!((Et=(Ft=o.calendarServiceHelper)==null?void 0:Ft.state)!=null&&Et.isPaymentEnabled)&&qo(z.value,Lt)),(Pt=(Ge=o.calendarServiceHelper)==null?void 0:Ge.setCustomState)==null||Pt.call(Ge,{showLoadingScreen:!1}),ne("onSubmit",{fingerprint:Le}),L.formData=u,L.appointment={recurrenceId:L.recurrenceId},na(),ne("onFormSubmitCallback",{formSubmissionData:L})}catch(Ee){const Bt={formData:Dt||L,eventId:L.ids.join(","),error:Ee.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};Me.appointmentBookingLogs((kt=(wt=o.calendarServiceHelper)==null?void 0:wt.state)==null?void 0:kt.traceId,Bt),(Tt=(Ke=o.calendarServiceHelper)==null?void 0:Ke.setCustomState)==null||Tt.call(Ke,{showLoadingScreen:!1,isBackButtonDisabled:!1})}if(o.calendar||ta(()=>{Tr("track",e.form.formSubmissionEvent,Jt.value)}),o.calendar){const Ee={contactId:L.contactId,calendarThankYouUrl:co.value,ids:L.ids,fingerprint:Le,event_address:L.eventAddress||"",cookiePayload:ge,fbEventId:Jt.value};ne("step",Ee);return}if(o.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1)window.top.location.href=oa(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,ge);else if("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")window.top.location.href=oa(e.form.redirect_url||e.form.redirectUrl,ge);else{Ve.value=!0;const Ee=e.form.formAction.thankyouText?Ca(e.form.formAction.thankyouText,ge):"Thanks for submiting details, Will get back to you soon!";k.value={action:"submit-form",message:Ee,style:e.form.submitMessageStyle,isFormPosted:Ve.value,height:(Vt=(At=o.formData)==null?void 0:At.form)==null?void 0:Vt.height},e.form.isLeadGenVideo&&ot.$emit("video-lead-popup-submitted",e.form.videoId)}e.form.isLeadGenVideo&&ot.$emit("video-lead-popup-submitted",e.form.videoId)}else throw A("unable_to_schedule_appointment")}).catch(E=>{var L,_e,be,Se,Ie,Ce;[429].includes(E.status)?Zt.value=!0:ho(),(L=o.calendarServiceHelper)==null||L.setCustomState({showLoadingScreen:!1});let k="";((_e=E==null?void 0:E.response)==null?void 0:_e.status)===502?k=((Se=(be=E==null?void 0:E.response)==null?void 0:be.data)==null?void 0:Se.msg)||"Something went wrong with your payment. Please try again.":k=((Ce=(Ie=E==null?void 0:E.response)==null?void 0:Ie.data)==null?void 0:Ce.msg)||A("unable_to_schedule_appointment"),ne("processError",{error:k})})}catch(b){if([429].includes(b.status)?Zt.value=!0:ho(),(gt=o.calendarServiceHelper)==null||gt.setCustomState({showLoadingScreen:!1}),o.calendar){let E="";((vt=b==null?void 0:b.response)==null?void 0:vt.status)===502?E=((bt=(_t=b==null?void 0:b.response)==null?void 0:_t.data)==null?void 0:bt.msg)||"Something went wrong with your payment. Please try again.":E=((It=(St=b==null?void 0:b.response)==null?void 0:St.data)==null?void 0:It.msg)||A("unable_to_schedule_appointment"),ne("processError",{error:E})}}},Sa=async(t,r)=>{var s,h,g,c,x,H,K,m,u,oe,ie,se,de;const n=Xe("msgsndr_id").value;if(t.status||t.id){let ce=t.formData,ee=t.fingerprint,ue=t.sessionFingerprint,Y={};if(n!==ee){const D=Xe("msgsndr_id",{path:"/",maxAge:31536e3});D.value=ee}try{o.calendar&&(ce=e.formFieldsValue,ee=(t==null?void 0:t.fingerprint)||((s=t==null?void 0:t.contact)==null?void 0:s.fingerprint)||t.contactId);const D="_ud";if(Y=await aa(t.contact,!0),o.calendar){const q=t==null?void 0:t.appointment,W=Or(o.locale),R=(C,S)=>fe(C).locale(W).format(S);if(q){const C={...q,only_end_date:R(q.only_end_date,"dddd, ll"),only_start_date:R(q.only_start_date,"dddd, ll"),start_time:R(q.start_time,"llll"),end_time:R(q.end_time,"llll")};Y={...Y,appointment:C,...t==null?void 0:t.contact}}}Bo(D,JSON.stringify(Y)),Da(z.value,ee),window.parent.postMessage(["set-sticky-contacts",D,JSON.stringify(Y),z.value,ee],"*"),window.parent.postMessage(["set-sticky-contacts",`embedded_iframe_${o.iFrameId}`,o.iFrameId,z.value,ee],"*"),o.event||(La({sessionId:t.sessionId||null,locationId:z.value}),ue&&qo(z.value,ue)),ne("onSubmit",{fingerprint:ee})}catch(D){const q={formData:ce||t,eventId:t.id,error:D.stack,isUserSessionLoad:window.userSessionAttribution,logs:window.ConsoleSubscriber?window.ConsoleSubscriber.getErrors():[]};Me.appointmentBookingLogs((g=(h=o.calendarServiceHelper)==null?void 0:h.state)==null?void 0:g.traceId,q)}if(o.calendar||ta(()=>{Tr("track",e.form.formSubmissionEvent,Jt.value)}),o.calendar){const D={contactId:t.contactId,calendarThankYouUrl:co.value,id:t.id,fingerprint:ee,event_address:t.event_address,cookiePayload:Y,fbEventId:Jt.value};ne("step",D);return}if(o.isCalendarService){const D={contactId:t.contactId,id:t.id,fingerprint:ee,event_address:t.event_address,cookiePayload:Y};ne("step",D);return}if(o.funnelPreview&&yo.value.length>0&&o.redirect===!1)try{o.extra||console.error("props.extra is undefined"),t.contact||console.error("data.contact is undefined");const D=await Xi(o.formData.locationId,e.form.id,yo.value,(x=(c=Qt.value)==null?void 0:c.coupon)==null?void 0:x.code,"form",!0);yo.value.forEach(R=>{var C,S;R.newPrice=(S=(C=D==null?void 0:D.products)==null?void 0:C.find($=>$.priceId===R._id))==null?void 0:S.itemSubtotalWithDiscount,R.showNewPrice=R.newPrice!==R.amount*R.qty});const q={products:yo.value||[],tax:((H=Qt.value)==null?void 0:H.taxSummary)||[],total:((K=Qt.value)==null?void 0:K.amount)||0,manualPaymentMethodId:(m=r==null?void 0:r.data)==null?void 0:m.manualPaymentMethodId,orderIds:(u=Qt.value)!=null&&u._id?[Qt.value._id]:[]},W=Bi(t.contact);await w(o.extra,he,q,W,!1,"","form")}catch(D){console.error("redirectAction error:",D)}if(o.redirect===!1)return;if("formAction"in e.form&&parseInt(e.form.formAction.actionType)===1&&!e.form.isLeadGenVideo){const D=oa(e.form.formAction.redirect_url||e.form.formAction.redirectUrl,Y);Pr(D)}else if(("redirect_url"in e.form&&e.form.redirect_url!==""||"redirectUrl"in e.form&&e.form.redirectUrl!=="")&&!e.form.isLeadGenVideo){const D=oa(e.form.redirect_url||e.form.redirectUrl,Y);Pr(D)}else if("formAction"in e.form&&parseInt((ie=(oe=e==null?void 0:e.form)==null?void 0:oe.formAction)==null?void 0:ie.actionType)==3)Ve.value=!0,Pe.value={action:"order",style:{width:e.form.width,style:e.form.style,fieldStyle:e.form.fieldStyle},productPurchased:tt.value.map(D=>(go.value.forEach(q=>{q._id===D.productId&&(D.showImage=q.showImage,D.showDescription=q.showDescription)}),D)),paymentType:ye.value.paymentType||Je.DONATION,isRecurringDonation:ye.value.isRecurringDonation,orderId:ye.value.orderId,donationAmount:e.formFieldsValue.payment,productSummary:Yt.value,couponCode:Zo.value,contact:t.contact};else{Ve.value=!0;const D=e.form.formAction.thankyouText?Ca(e.form.formAction.thankyouText,Y):"Thanks for submiting details, Will get back to you soon!";Pe.value={action:"submit-form",message:D,style:e.form.submitMessageStyle,isFormPosted:Ve.value,height:(de=(se=o.formData)==null?void 0:se.form)==null?void 0:de.height},e.form.isLeadGenVideo&&ot.$emit("video-lead-popup-submitted",e.form.videoId)}e.form.isLeadGenVideo&&ot.$emit("video-lead-popup-submitted",e.form.videoId)}},Kn=async t=>{var r,n,s;if(t.type==="error")t.message&&(e.form.payment.required||uo.value||fo.value)&&(pe.value=!1,te({tag:"payment",error:t.message}));else if(t.type==="pre_process")o.funnelPreview&&_i(he.value.funnelId,{products:[],tax:[],total:0},"v2"),await Mt(t.data,t.provider);else if(t.type==="success"){o.funnelPreview&&Bo("pmc_id",nn.value),sessionStorage.removeItem(`formOrderResponse-${o.formId}`);const h={submissionId:mo.value,orderId:ye.value.orderId,paymentType:((r=ye.value)==null?void 0:r.paymentType)===Je.PRODUCT?Je.PRODUCT:Je.DONATION,locationId:z.value,formId:o.formId,transactionId:["authorize-net","nmi","square"].includes(t.provider)?(n=t.data)==null?void 0:n.transactionId:(s=t.data.data)==null?void 0:s.transactionId};await fr(h,ma.value,t)}},fr=async(t,r,n)=>{try{await bi.patchSubmission(t),Sa(r,n)}catch(s){console.error(s),Sa(r,n)}},pr=async()=>{var n;const t=sessionStorage.getItem(`formData-${o.formId}`);if(t){const s=JSON.parse(t);Mo(o.urlParams,F,s.phoneCountryIncluded,s.formattedCountry,s.formFieldsValue,s.formFields,we.value).then(h=>{e.phoneCountryIncluded=h.phoneCountryIncluded,e.formFieldsValue=h.formFieldsValue,M.value=h.formattedCountry,I.value=h.formFields,setTimeout(()=>ba(),1e3)})}const r=sessionStorage.getItem(`submissionResponse-${o.formId}`);if(t&&r){const s=JSON.parse(t),h=JSON.parse(r),g={submissionId:s.submissionId,orderId:s.productPurchased.orderId,paymentType:((n=s.productPurchased)==null?void 0:n.paymentType)===Je.PRODUCT?Je.PRODUCT:Je.DONATION,locationId:z.value,formId:o.formId,transactionId:F.query.transactionId||"51651414"};ye.value=s.productPurchased,tt.value=s.productPurchasedList,Yt.value=s.productSummary,await fr(g,h)}},Jn=()=>{!o.calendar&&!o.isCalendarService||(We.value=I.value.map(t=>t.tag),setTimeout(()=>{var t;ji(((t=o.calendar)==null?void 0:t.id)||z.value,We.value,e.formFieldsValue,e.phoneCountryIncluded,M.value).then(r=>{if(r){e.formFieldsValue=r.formFieldsValue,e.phoneCountryIncluded=r.phoneCountryIncluded,M.value=r.formattedCountry;for(let n in e.phoneCountryIncluded)e.phoneCountryIncluded[n]&&Xo({tag:n})}else console.warn("session data not found! skipping contact fill")}).catch(r=>{console.error("Failed at loadDataFromSessionStorage",r)})},Pa()?1005:100))},Yn=async t=>{t.type==="error"&&(t!=null&&t.message)&&(ne("disableBackOnSubmit",{disable:!1}),pe.value=!1),ne("onProcessCalendarPayment",{...t,component:"FormComponent"})},Qn=t=>{[...il,"payment_session_id","calendarElementClass"].forEach(n=>{var s;(s=t==null?void 0:t.eventData)==null||delete s.url_params[n]})},yr=le(()=>{var t;return!e.formFieldsValue||!Object.keys(e.formFieldsValue).length?!0:(t=e.form)==null?void 0:t.fields.some(r=>{if(r.hidden||!r.required||!r.tag||r.tag==="locationConfiguration")return!1;const n=e.formFieldsValue[r.tag],s=e.phoneCountryCode[r.tag];if(!n)return!0;const h=r.type==="email"||typeof(r==null?void 0:r.fieldKey)=="string"&&r.fieldKey.toLowerCase().endsWith(".email")||typeof(r==null?void 0:r.hiddenFieldQueryKey)=="string"&&r.hiddenFieldQueryKey.toLowerCase().includes("email")||typeof(r==null?void 0:r.label)=="string"&&r.label.toLowerCase().includes("email"),g=r.tag==="phone";return h?!Yi(n):g?!Ji(n,s):r.tag==="terms_and_conditions"?!n:!1})});i({hasInvalidFormInputs:yr}),mi(()=>{ot.$off("submitCalendarForm",Mt),ot.$off("submitCalendarServiceForm",Mt)});const Zn=()=>{var t,r,n,s;return xt.value&&((r=(t=e.form.formAction)==null?void 0:t.mobileHeaderImageSrc)!=null&&r.trim())?e.form.formAction.mobileHeaderImageSrc:((s=(n=e.form.formAction)==null?void 0:n.headerImageSrc)==null?void 0:s.trim())||""};Fr(()=>{Kt.value=Zn()}),Kt.value=((br=(_r=e.form.formAction)==null?void 0:_r.headerImageSrc)==null?void 0:br.trim())||"";function _o(t){var r,n;(n=(r=o==null?void 0:o.calendarServiceHelper)==null?void 0:r.setCustomState)==null||n.call(r,{isSubmitting:!1,error:t}),o.isCalendarService&&ne("onFormSubmitCallback",{isError:!0})}const Xn=le(()=>{var r,n,s,h,g,c;const t=xt.value?((n=(r=e.form)==null?void 0:r.style)==null?void 0:n.mobilePadding)||((h=(s=e.form)==null?void 0:s.style)==null?void 0:h.padding):(c=(g=e.form)==null?void 0:g.style)==null?void 0:c.padding;return(t==null?void 0:t.extraPaddingComputingProcessed)===!0});return(t,r)=>{var rt,nt;const n=Ii,s=ll,h=Ci,g=sl,c=dl,x=cl,H=ul,K=ml,m=Fi,u=Ei,oe=fl,ie=Ti,se=pl,de=yl,ce=hl,ee=gl,ue=vl,Y=_l,D=bl,q=Di,W=Sl,R=Il,C=Cl,S=Fl,$=El,me=Pl,re=Oi,Q=wl,ae=kl,De=Tl,ke=Al,Te=Vl,Ze=Dl,je=Ll;return O(),oo("div",Ol,[Fa(n,{type:"text/css",children:a(Ja)},null,8,["children"]),Fa(n,{type:"text/css",children:a(nr)},null,8,["children"]),ao("section",{id:"form-builder",class:xo(["hl_form-builder--main",[a(e).form.fullScreenMode?"hl_form-builder--main-full":"",a(en)?"hl_form-builder--main--custom-margin":""]]),style:ro(a(fn))},[a(Kt).trim().length>0?(O(),oo("div",Rl,[ao("div",{class:"max-w-full ghl-banner w-full",style:ro({maxWidth:a(fa)+"px"})},[Fa(s,{url:a(Kt),width:a(fa),alt:"banner"},null,8,["url","width"])],4)])):xe("",!0),ao("div",{style:ro({maxWidth:a(fa)+"px",marginBottom:a(e).form.fullScreenMode?"0 !important":""}),class:"ghl-form-wrap"},[a(Ve)?xe("",!0):(O(),oo("div",{key:0,id:"_builder-form",style:ro(a(Zr)()),name:"builder-form",class:xo(["form-builder--wrap",a(e).form.fullScreenMode?"form-builder--wrap-full":""])},[ao("div",{class:xo([a(Ht)?"builder-inline":"flex-col",a(J)?"":"extra-top-padding","row fields-container",a(Xn)?"remove-extra-padding":""])},[(O(!0),oo(fi,null,pi(a(I).filter(d=>{var V,ze;return!a(kr)((ze=(V=o.formData)==null?void 0:V.form)==null?void 0:ze.fields,d)}),(d,V)=>{var ze,it,lt,st,dt,ct,ut,mt,ft,pt,yt,ht,gt,vt,_t,bt,St,It,b,E,k,L,_e,be,Se,Ie,Ce,Ne,Ae,Ue,Fe,Ct,Ft,Et,Ge,Pt,wt,kt,Ke,Tt,At,Vt,Dt,Le,Lt,ge,Ee,Bt,bo,So,Io,Co,Fo,Eo,Po,wo,ko,To,Ao,Vo,Do,Lo,Oo,Ro,zo;return O(),oo("div",{key:V,id:"el_"+o.formId+"_"+d.tag+"_"+V,style:ro(hn(d)),class:xo([[pn(d,V),a(Ht)?"menu-field-wrap":"",{calendar_notes:d.tag==="calendar_notes"},{location_picker:d.tag==="locationConfiguration"},{"payment-block":d.type==="payment"}],"form-field-wrapper"]),onFocusin:v=>_a(v,d),onClick:v=>_a(v,d),onFocus:v=>_a(v,d)},[ao("div",{class:xo([V%2==0?"f-even":"f-odd","form-field-container"])},[d.type==="text"?(O(),N(h,{key:0,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(it=(ze=a(e).form)==null?void 0:ze.fieldStyle)==null?void 0:it.labelAlignment,"phone-country-included":a(e).phoneCountryIncluded,"phone-country-code":a(e).phoneCountryCode,"location-country":a(va),"form-fields-value":a(e).formFieldsValue,"formatted-phone":a(e).formattedPhone,"phone-country-derived":a(Nt),errors:a(e).errors,"layout-type":a(e).form.layout,"check-full-width-position":vo(V),"font-size":(dt=(st=(lt=a(e))==null?void 0:lt.form)==null?void 0:st.fieldStyle)==null?void 0:dt.placeholderFontSize,locationId:(ct=o==null?void 0:o.formData)==null?void 0:ct.locationId,"medium-id":l.formId,onVerifyPhone:Ka,onUpdateToken:ha,onUpdatePhoneCountryDerived:sr,onCustomFieldPhoneNumberUpdate:Xo,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","phone-country-included","phone-country-code","location-country","form-fields-value","formatted-phone","phone-country-derived","errors","layout-type","check-full-width-position","font-size","locationId","medium-id"])):d.type==="phone"?(O(),N(g,{key:1,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(mt=(ut=a(e).form)==null?void 0:ut.fieldStyle)==null?void 0:mt.labelAlignment,"phone-country-included":a(e).phoneCountryIncluded,"phone-country-code":a(e).phoneCountryCode,"location-country":a(va),"form-fields-value":a(e).formFieldsValue,"phone-country-derived":a(Nt),"formatted-phone":a(e).formattedPhone,errors:a(e).errors,"layout-type":a(e).form.layout,"check-full-width-position":vo(V),"font-size":(yt=(pt=(ft=a(e))==null?void 0:ft.form)==null?void 0:pt.fieldStyle)==null?void 0:yt.placeholderFontSize,locationId:(ht=o==null?void 0:o.formData)==null?void 0:ht.locationId,"medium-id":l.formId,onVerifyPhone:Ka,onUpdateToken:ha,onAddOrUpdateError:te,onUpdatePhoneCountryDerived:sr,onCustomFieldPhoneNumberUpdate:Xo,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","phone-country-included","phone-country-code","location-country","form-fields-value","phone-country-derived","formatted-phone","errors","layout-type","check-full-width-position","font-size","locationId","medium-id"])):d.type==="number"||d.type==="numerical"||d.dataType==="SCORE"?(O(),N(c,{key:2,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(vt=(gt=a(e).form)==null?void 0:gt.fieldStyle)==null?void 0:vt.labelAlignment,"form-fields-value":a(e).formFieldsValue,errors:a(e).errors,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","errors"])):d.type==="rating"?(O(),N(x,{key:3,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(bt=(_t=a(e).form)==null?void 0:_t.fieldStyle)==null?void 0:bt.labelAlignment,"form-fields-value":a(e).formFieldsValue,errors:a(e).errors,"layout-type":a(e).form.layout,"check-full-width-position":vo(V),"font-size":(b=(It=(St=a(e))==null?void 0:St.form)==null?void 0:It.fieldStyle)==null?void 0:b.placeholderFontSize,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","errors","layout-type","check-full-width-position","font-size"])):d.type==="email"?(O(),N(H,{key:4,kind:"form","medium-id":l.formId,item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(k=(E=a(e).form)==null?void 0:E.fieldStyle)==null?void 0:k.labelAlignment,"form-fields-value":a(e).formFieldsValue,errors:a(e).errors,"layout-type":a(e).form.layout,"check-full-width-position":vo(V),"font-size":(be=(_e=(L=a(e))==null?void 0:L.form)==null?void 0:_e.fieldStyle)==null?void 0:be.placeholderFontSize,onAddOrUpdateError:te,onVerifyEmail:un,onUpdateToken:ha,locationId:(Se=o==null?void 0:o.formData)==null?void 0:Se.locationId,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["medium-id","item","form-label-visible","form-label-alignment","form-fields-value","errors","layout-type","check-full-width-position","font-size","locationId"])):xe("",!0),d.type==="h1"?(O(),N(K,{key:5,item:a(Z)(d)},null,8,["item"])):d.type==="textbox_list"?(O(),N(m,{key:6,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Ce=(Ie=a(e).form)==null?void 0:Ie.fieldStyle)==null?void 0:Ce.labelAlignment,"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(Oe),errors:a(e).errors,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","local-tag-id","errors"])):d.type==="textarea"||d.type=="large_text"?(O(),N(u,{key:7,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Ae=(Ne=a(e).form)==null?void 0:Ne.fieldStyle)==null?void 0:Ae.labelAlignment,"form-fields-value":a(e).formFieldsValue,errors:a(e).errors,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","errors"])):d.type==="img"&&"url"in d?(O(),N(oe,{key:8,kind:"form",item:a(Z)(d),ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item"])):d.type==="html"&&a(la)&&a(Ra)?(O(),N(ie,{key:9,item:a(Z)(d),localTagId:a(Oe)+V,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","localTagId"])):d.type==="captcha"?(O(),N(se,{key:10,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Fe=(Ue=a(e).form)==null?void 0:Ue.fieldStyle)==null?void 0:Fe.labelAlignment,"captcha-input-value":a(Yo),"local-tag-id":a(Oe),"validation-error":a(e).validationError,onUpdateValidationError:wn,onUpdateIsCaptchaVerified:Dn,onUpdateCaptchaToken:On,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","captcha-input-value","local-tag-id","validation-error"])):d.type==="monetory"?(O(),N(de,{key:11,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Ft=(Ct=a(e).form)==null?void 0:Ct.fieldStyle)==null?void 0:Ft.labelAlignment,"form-fields-value":a(e).formFieldsValue,"locale-currency":a(Cn),errors:a(e).errors,onAddOrUpdateError:te,primaryColor:(Pt=(Ge=(Et=a(e))==null?void 0:Et.form)==null?void 0:Ge.fieldStyle)==null?void 0:Pt.primaryColor,onUpdateFormFieldsValue:eo,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","locale-currency","errors","primaryColor"])):d.type==="checkbox"?(O(),N(ce,{key:12,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(kt=(wt=a(e).form)==null?void 0:wt.fieldStyle)==null?void 0:kt.labelAlignment,"form-fields-value":a(e).formFieldsValue,layout:a(e).form.layout,"local-tag-id":a(Oe),errors:a(e).errors,onAddOrUpdateError:te,onUpdateFormFieldsValue:eo,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","layout","local-tag-id","errors"])):d.type==="terms_and_conditions"?(O(),N(ee,{key:13,kind:"form",item:a(Z)(d),"form-label-visible":a(J),labelFontFamily:a(e).fieldStyle.labelFontFamily,"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(Oe),errors:a(e).errors,onAddOrUpdateError:te,onUpdateFormFieldsValue:eo,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","labelFontFamily","form-fields-value","local-tag-id","errors"])):d.type==="radio"&&d.picklistOptions?(O(),N(ue,{key:14,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Tt=(Ke=a(e).form)==null?void 0:Ke.fieldStyle)==null?void 0:Tt.labelAlignment,"form-fields-value":a(e).formFieldsValue,"local-tag-id":a(Oe),errors:a(e).errors,layout:a(e).form.layout,onAddOrUpdateError:te,onResetFieldsValue:Mn,onSetRadioValue:Bn,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","local-tag-id","errors","layout"])):d.type==="radio"&&d.picklistOptionsImage?(O(),N(Y,{key:15,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Vt=(At=a(e).form)==null?void 0:At.fieldStyle)==null?void 0:Vt.labelAlignment,"form-fields-value":a(e).formFieldsValue,layout:a(e).form.layout,"local-tag-id":a(Oe),errors:a(e).errors,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","layout","local-tag-id","errors"])):d.type==="select"&&d.tag==a(yi).COUNTRY?(O(),N(D,{key:16,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Le=(Dt=a(e).form)==null?void 0:Dt.fieldStyle)==null?void 0:Le.labelAlignment,"formatted-country":a(M),countries:a(ar),errors:a(e).errors,onUpdateFormattedCountry:dr,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-label-alignment","formatted-country","countries","errors"])):d.type==="single_options"||d.type==="multiple_options"?(O(),N(q,{key:17,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-fields-value":a(e).formFieldsValue,"form-label-alignment":(ge=(Lt=a(e).form)==null?void 0:Lt.fieldStyle)==null?void 0:ge.labelAlignment,errors:a(e).errors,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-label-visible","form-fields-value","form-label-alignment","errors"])):d.type==="date"?(O(),N(W,{key:18,kind:"form",item:a(Z)(d),"form-label-visible":a(J),"form-label-alignment":(Bt=(Ee=a(e).form)==null?void 0:Ee.fieldStyle)==null?void 0:Bt.labelAlignment,"form-fields-value":a(e).formFieldsValue,errors:a(e).errors,ref_for:!0,ref:v=>{a(B)[V]=v},onDateSelected:Rn,onAddOrUpdateError:te},null,8,["item","form-label-visible","form-label-alignment","form-fields-value","errors"])):d.type==="payment"&&a(tr)?(O(),N(R,{key:19,calendar:l.calendar,payment:a(Re),stripe:a(y),card:a(U),"card-error-msg":a(He),onUpdateStripe:kn,onUpdateCard:Tn,onUpdateCardErrorMsg:Vn,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["calendar","payment","stripe","card","card-error-msg"])):d.type==="payment"&&a(or)&&a(la)?(O(),N(C,{key:20,kind:"form",calendar:l.calendar,payment:a(Re),setAuthorizeNetNewCardDetails:An,authorizeNetCardNumberError:a(Ma),authorizeNetCardExpiryError:a(Ba),authorizeNetCardCVCError:a(qa),setAuthorizeNetCardNumberError:a($a),setAuthorizeNetExpiryError:a(Ha),setAuthorizeNetCVCError:a(Wa),authorizeNetErrorResponse:a(an)},null,8,["calendar","payment","authorizeNetCardNumberError","authorizeNetCardExpiryError","authorizeNetCardCVCError","setAuthorizeNetCardNumberError","setAuthorizeNetExpiryError","setAuthorizeNetCVCError","authorizeNetErrorResponse"])):!l.calendar&&d.type==="payment"&&(((So=(bo=a(e).form)==null?void 0:bo.payment)==null?void 0:So.paymentType)==="product"&&a(Ya)&&a(go).length>0||((Co=(Io=a(e).form)==null?void 0:Io.payment)==null?void 0:Co.paymentType)!=="product")?(O(),N(S,{key:21,kind:"form",item:a(Z)(d),payment:a(e).form.payment,products:a(go),"bump-products":a(xa),style:ro(a(e).form.fieldStyle),"form-label-visible":a(J),"form-label-alignment":(Eo=(Fo=a(e).form)==null?void 0:Fo.fieldStyle)==null?void 0:Eo.labelAlignment,locationId:a(z),"form-id":l.formId,recurringDonationProduct:a(Na),isPaymentInProcessing:a(pe),"form-name":l.formData.name,errors:a(e).errors,formItems:a(e).form,formValues:a(e).formFieldsValue,"phone-country-code":a(e).phoneCountryCode,"location-country":a(va),onOnPaymentCallback:Kn,onAddOrUpdateError:te,onPaymentAmount:dn,onProductOrder:cn,onOnOrderApiFail:r[0]||(r[0]=()=>hi(pe)?pe.value=!1:pe=!1),onProductSelected:Fn,onCouponCode:En,ref_for:!0,ref:v=>{a(B)[V]=v,za.value=v}},null,8,["item","payment","products","bump-products","style","form-label-visible","form-label-alignment","locationId","form-id","recurringDonationProduct","isPaymentInProcessing","form-name","errors","formItems","formValues","phone-country-code","location-country"])):d.type==="file_upload"?(O(),N($,{key:22,kind:"form",item:a(Z)(d),"form-fields-value":a(e).formFieldsValue,"form-label-visible":a(J),"form-label-alignment":(wo=(Po=a(e).form)==null?void 0:Po.fieldStyle)==null?void 0:wo.labelAlignment,errors:a(e).errors,onUpdateFormFieldsValue:eo,onAddOrUpdateError:te,ref_for:!0,ref:v=>{a(B)[V]=v}},null,8,["item","form-fields-value","form-label-visible","form-label-alignment","errors"])):d.type==="signature"?(O(),N(me,{key:23,kind:"form",item:a(Z)(d),"form-fields-value":a(e).formFieldsValue,"form-label-visible":a(J),"form-label-alignment":(To=(ko=a(e).form)==null?void 0:ko.fieldStyle)==null?void 0:To.labelAlignment,ref_for:!0,ref:v=>{a(B)[V]=v},errors:a(e).errors,onUpdateFormFieldsValue:eo,onAddOrUpdateError:te},null,8,["item","form-fields-value","form-label-visible","form-label-alignment","errors"])):d.type==="submit"&&(a(Zt)||!a(Za))?(O(),N(re,{key:24,item:a(Z)(d),"show-recaptcha":a(Zt),layout:a(e).form.layout,"form-label-visible":a(e).form.formLabelVisible,"button-style":a(e).buttonStyle,calendar:l.calendar,"form-submit-disable":a(pe),onClick:Mt,"onUpdate:recaptchaToken":ln,ref_for:!0,ref:v=>{a(B)[V]=v},errors:a(e).errors},null,8,["item","show-recaptcha","layout","form-label-visible","button-style","calendar","form-submit-disable","errors"])):d.tag==="group_address"?(O(),N(Q,{key:25,kind:"form",item:a(Z)(d),"form-fields-value":a(e).formFieldsValue,"form-label-visible":a(J),"form-label-alignment":(Vo=(Ao=a(e).form)==null?void 0:Ao.fieldStyle)==null?void 0:Vo.labelAlignment,"formatted-country":a(M),countries:a(ar),ref_for:!0,ref:v=>{a(B)[V]=v},errors:a(e).errors,onUpdateFormFieldsValue:eo,onUpdateFormattedCountry:dr,onAddOrUpdateError:te,addressData:a(we),fieldSpacing:(Oo=(Lo=(Do=a(e))==null?void 0:Do.form)==null?void 0:Lo.style)==null?void 0:Oo.fieldSpacing,fieldStyle:a(e).fieldStyle,locationId:(Ro=o==null?void 0:o.formData)==null?void 0:Ro.locationId,companyId:(zo=o==null?void 0:o.formData)==null?void 0:zo.companyId,fields:a(I),id:l.formId,source:"forms"},null,8,["item","form-fields-value","form-label-visible","form-label-alignment","formatted-country","countries","errors","addressData","fieldSpacing","fieldStyle","locationId","companyId","fields","id"])):xe("",!0)],2)],46,zl)}),128)),a(Za)?(O(),oo("div",Nl,[l.isNewCalendarWidgetEnabled?(O(),N(ae,{key:0,guests:l.guests,"guest-count-detail":l.guestCountDetail,"collect-guest-count":a(er),"is-mandatory-guest-enabled":a(Xa),"seats-per-slot-data":o.seatsPerSlotData,"form-fields-value":a(e).formFieldsValue,ref:d=>ga(d),onAddOrUpdateError:te},null,8,["guests","guest-count-detail","collect-guest-count","is-mandatory-guest-enabled","seats-per-slot-data","form-fields-value"])):(O(),N(De,{key:1,guests:l.guests,"guest-count-detail":l.guestCountDetail,"collect-guest-count":a(er),"is-mandatory-guest-enabled":a(Xa),"seats-per-slot-data":o.seatsPerSlotData,"form-fields-value":a(e).formFieldsValue,ref:d=>ga(d),onAddOrUpdateError:te},null,8,["guests","guest-count-detail","collect-guest-count","is-mandatory-guest-enabled","seats-per-slot-data","form-fields-value"])),a(Qa)?(O(),N(re,{key:2,item:a(Qa),"button-style":a(e).buttonStyle,calendar:l.calendar,"form-submit-disable":a(pe),onClick:Mt,ref:d=>ga(d),errors:a(e).errors,class:"menu-field-wrap col-sm-12 col-12 calendar_notes mt-20"},null,8,["item","button-style","calendar","form-submit-disable","errors"])):xe("",!0)])):xe("",!0)],2),l.formData!=null&&a(io)?(O(),N(ke,{key:0,company:a(e).company},null,8,["company"])):xe("",!0)],6)),a(Pe)&&a(Pe).action==="order"?(O(),N(Te,{key:1,id:"order-confirmation",payload:a(Pe)},null,8,["payload"])):xe("",!0),a(Pe)&&a(Pe).action==="submit-form"?(O(),N(Ze,{key:2,id:"_builder-form",payload:a(Pe)},null,8,["payload"])):xe("",!0),a(In)?(O(),N(je,{key:3,ref:l.calendarServiceHelper.newCardPaymentElementRef,state:l.calendarServiceHelper.state,showSessionExpire:!1,hasInvalidFormInputs:a(yr),onOnPaymentCallback:Yn,onUpdateState:r[1]||(r[1]=d=>l.calendarServiceHelper.setCustomState(d))},null,8,["state","hasInvalidFormInputs"])):xe("",!0)],4)],6),ao("div",Ul,[l.calendar?(O(),N(ol,{key:0,loading:a(po)&&!((nt=(rt=l.calendarServiceHelper)==null?void 0:rt.state)!=null&&nt.isPaymentEnabled),color:"#188bf6",size:"30px"},null,8,["loading"])):xe("",!0)])],512)}}});export{ys as C,hs as _,ps as i,il as r};
