const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./ghl-payment-element.Dad5BXrt.css","./PaymentElementComponent.BtAYlWo5.css","./PaymentElementModal.P3XEehDC.css"])))=>i.map(i=>d[i]);
import{d as Ht,T as qt,a2 as Jt,B as zt,Z as Ae,r as y,c as Me,P as C,a0 as Gt,o as Kt,a as k,b as L,u as g,m as ot,s as le,Y as st,e as $,l as R,t as ae,q as Ue,E as Yt,H as Zt,y as Qt,k as jt,F as Xt,I as ea,J as ie,bF as lt,a4 as it,a5 as ut,n as ta,au as ct,bV as Fe,aW as ve,bS as dt,bE as mt,bW as vt,bX as Oe,bY as pt,bD as yt,w as $e,x as Be}from"./8xvvzpeQ.js";import{_ as aa}from"./DYa7OZHt.js";import{u as ra,S as E,E as X}from"./BFYQybQu.js";import{t as na,f as oa}from"./WnAHhi8M.js";import{O as pe,P as ee,l as sa,a as ke,g as Te,b as xe,d as la}from"./oo_a1T_D.js";import{F as ft}from"./Cvp-3ycD.js";import{h as ia,f as De,b as ua,g as ca,d as da,e as ma}from"./DVjDpNcn.js";import{p as va}from"./wwLfBoTf.js";import{u as pa}from"./DII_iCb6.js";import{_ as ya}from"./BrQJU4K_.js";import"./Cmg2wZf4.js";import"./DR7EPPBp.js";import"./BPJmMdw_.js";import"./DCID7Uvk.js";import"./DR8Wfbq3.js";import"./TNK_wdwi.js";import"./Dmt1cPZn.js";import"./CxItw0pz.js";import"./DW-3PSLe.js";import"./D8y3k-bd.js";const fa=$e(()=>Be(()=>import("./DleH2ADF.js"),[],import.meta.url).then(p=>p.default||p)),_a=$e(()=>Be(()=>import("./BVZrXEba.js"),__vite__mapDeps([0,1]),import.meta.url).then(p=>p.default||p)),ha=$e(()=>Be(()=>import("./10v2ZDiA.js"),__vite__mapDeps([0,2]),import.meta.url).then(p=>p.default||p)),ga=["id","href","target","rel","data-animation-class","aria-label"],Pa={key:0,style:{"margin-right":"5px"},class:"button-icon-start"},Ia={class:"main-heading-button"},ba={key:1,style:{"margin-left":"5px"},class:"button-icon-end"},Ea={class:"sub-heading-button"},Sa={key:1,class:"recaptcha-container button-recaptcha-container"},wa={key:0},Oa=["disabled","data-animation-class","id","aria-label"],ka={key:0,class:"button-icon-start"},Ta={class:"main-heading-button"},xa={key:1,class:"button-icon-end"},Ca={class:"sub-heading-button"},La={class:"btn-loader-position",style:{left:"50%",position:"absolute",top:"50%",transform:"translate(-50%, -50%)"}},Ra={key:0},Na=["id"],Aa={key:0,class:"card-el-error-msg"},Ma={key:3,class:"card-el-error-msg error-message",style:{"justify-content":"center"}},Ua={inheritAttrs:!1},rr=Ht({...Ua,__name:"Button",props:{element:{type:Object,required:!0},classStyles:{type:Array,required:!0}},setup(p){var je,Xe,et,tt,at,rt,nt;const i=p,a=qt(),{openPopup:_t}=ra(),ye=Jt(i.element),{call:ht,createMembershipToken:Ve,mailTo:gt,sms:Pt,goToNextFunnelStep:ue,openUrl:Ce,downloadFile:It,getNextFunnelStepURL:bt,goToStep:Et}=pa(),St=zt(),{$bus:We}=St;let re=(Xe=(je=i.element.extra)==null?void 0:je.text)==null?void 0:Xe.value;re=Ae(re);let ne=(tt=(et=i.element.extra)==null?void 0:et.subText)==null?void 0:tt.value;ne=Ae(ne);const wt=a.value.funnelId,Ot=a.value.stepId,kt=a.value.funnelPageId,h=a.value.locationId,H=(nt=(rt=(at=i.element.extra)==null?void 0:at.productId)==null?void 0:rt.value)==null?void 0:nt.id,_=y(!1),fe=y(!1),Le=y(""),Re=y(""),O=y(),He=y(!1),_e=y(""),oe=y(""),N=y(!1),q=y(!1),Tt=Me(()=>{var e;return((e=O.value)==null?void 0:e.price.type)==="recurring"}),u=y(),A=y(""),ce=y(!1),J=y(),de=y(""),qe=y(!1),D=y(!0),z=y(),Je=ea(),ze=y(),G=y({mode:"payment",amount:0,currency:"",contact:{id:"",full_name:"",email:"",phone:"",shippingAddress:{city:"",state:"",country:"",zipCode:"",line1:""}}}),he=y(),ge=y(),U=y({mode:"payment",amount:0,currency:"usd",enableBNPL:!0,paymentMethodConfiguration:a.value.isLivePaymentMode?Je.public.STRIPE_DEFAULT_CONFIGURATION_LIVE:Je.public.STRIPE_DEFAULT_CONFIGURATION_TEST}),Ge=y(""),B=y(!1),{action:{value:te},visitWebsite:{value:V}}=i.element.extra,K=Me(()=>{var e;return((e=a.value.paymentProviderDetails)==null?void 0:e.provider)===C.CUSTOM_PROVIDER&&!!a.value.customProviderPublishableKey&&te===E.SELL_PRODUCT}),xt=async e=>{e.type==="ready"?(D.value=!1,z.value="",_.value=!1):e.type==="processing"?(N.value=!0,z.value=""):e.type==="error"?(e.message==="Request failed with status code 429"?(J.value=void 0,ce.value=!0):z.value=e.message,N.value=!1,D.value=!1):e.type==="success"?(z.value="",N.value=!1,await Ct(e)):e.type==="close"&&(z.value="Payment cancelled",N.value=!1,D.value=!1)},Ct=async e=>{try{let t=localStorage.getItem("_ud");t&&(t=JSON.parse(t));const{paymentResponseData:l}=await ia(t,e.data,e.provider,h);await me(l)}catch(t){z.value=t}finally{sessionStorage.removeItem("orderResponse"),sessionStorage.removeItem("contactResponse")}},Ke=()=>{const e=(re??"")+" "+(ne??"");if(re||ne)return e;if(te===E.GO_TO_URL){const{visitWebsite:{value:t}}=i.element.extra;return t==null?void 0:t.url}return e},Lt=e=>{if(!e){de.value="Verification failed! Please try again";return}de.value="",J.value=e},Ye=[E.CLICK_TO_CALL,E.CLICK_TO_SMS,E.GO_TO_URL,E.GO_TO_STEP];Ye.includes(te)&&(fe.value=!0,Gt(V==null?void 0:V.url)||(Le.value=Qe())),Kt(()=>{Ye.includes(te)&&(fe.value=!0,Le.value=Qe()),a.value.orderFormVersion===2&&H&&te===E.SELL_PRODUCT&&(Rt(),he.value=JSON.parse(localStorage.getItem("_ud")||"{}").country)});async function Rt(){var e,t,l,c,d,m,o,f,v,P;try{const r=await ft.findProductById({productId:H});let S=localStorage.getItem("pmc_id");U.value.paymentMethodConfiguration=S;const M=(e=r==null?void 0:r.price)==null?void 0:e.setupFee,T=(t=r==null?void 0:r.price)==null?void 0:t.trialPeriod,w=(l=r==null?void 0:r.price)==null?void 0:l.amount,I=M?T?M:w+M:T?0:w;r.amount=I,O.value={...r,qty:1,amount:r.amount},oe.value=(c=r==null?void 0:r.price)==null?void 0:c.currency,G.value.amount=O.value.amount,G.value.currency=oe.value,G.value.mode=((d=O.value)==null?void 0:d.price.type)==="recurring"?"subscription":"payment",G.value.productDetails=[{productId:(m=r==null?void 0:r.product)==null?void 0:m._id,priceId:(o=r==null?void 0:r.price)==null?void 0:o._id}],U.value.amount=O.value.amount,U.value.currency=oe.value.toLowerCase(),((f=O.value)==null?void 0:f.price.type)==="recurring"?U.value.mode="subscription":O.value.amount?U.value.mode="payment":(U.value.mode="setup",U.value.amount=void 0);let n=localStorage.getItem("_ud");n&&(n=JSON.parse(n),G.value.contact={id:n==null?void 0:n.id,full_name:n==null?void 0:n.full_name,email:n==null?void 0:n.email,phone:n==null?void 0:n.phone,shippingAddress:{city:n==null?void 0:n.city,state:ge.value,country:n==null?void 0:n.country,zipCode:n==null?void 0:n.postal_code,line1:n==null?void 0:n.address1}}),setTimeout(()=>{qe.value=!0},1e3)}catch(r){const S=((P=(v=r==null?void 0:r.response)==null?void 0:v.data)==null?void 0:P.message)||(r==null?void 0:r.message)||"Not able to fetch products!";console.error(S),alert("Not able to fetch products!")}}async function Nt(){var t,l,c,d,m,o,f,v,P,r,S,M,T,w,I,n,F,W,se,Pe,Ie,be,Ee,Se;const{action:e}=i.element.extra;switch(e.value){case"openPopup":{const s=((t=i.element.extra.popupId)==null?void 0:t.value)??"";na(a.value.stepId),_t(s);break}case"url":{const{visitWebsite:s}=i.element.extra;Ce(s.value);break}case E.SHOW_HIDE_ELEMENT:{const{hideElements:s,showElements:x}=i.element.extra;ut(s.value),it(x.value);break}case E.HIDE_ELEMENT:{const{hideElements:s}=i.element.extra;ut(s.value);break}case E.SHOW_ELEMENT:{const{showElements:s}=i.element.extra;it(s.value);break}case"scroll-to-element":{const{scrollToElement:s}=i.element.extra;We.$emit("scroll-to-element",s.value);break}case"go-to-next-funnel-step":{_.value=!0,ue();break}case E.GO_TO_STEP:{_.value=!0,ue(i.element.extra.stepPath.value);break}case"sell-product":{if(_.value)return;_.value=!0;const s=`_pl_${a.value.funnelId}`,x=localStorage.getItem(s);let b;if(x&&(b=JSON.parse(x)),a.value.orderFormVersion===2){const we=ie("provider").value;if(((l=O.value)==null?void 0:l.amount)===0){const Q=Ze();if(!Q)return;const j=await De(h,Q);if(j.paymentProvider==="gift_card"){await Y(),B.value=!0;return}if(j.paymentProvider==="free-checkout"||!a.value.requireCreditCard){const Ne={altId:a.value.locationId,altType:"location",source:{type:a.value.pageType===pe.FUNNEL?pe.FUNNEL:pe.WEBINAR?pe.WEBINAR:pe.WEBSITE,id:a.value.funnelId,name:a.value.funnelName},products:[{id:O.value._id,qty:1}]},$t=await ee.getAmountSummary(Ne),Bt=((c=O.value)==null?void 0:c.price.type)==="recurring",Vt=((d=$t.recurringSummary)==null?void 0:d.subtotalWithDiscount)>0,Wt=j.paymentProvider==="free-checkout";if(Bt&&Vt||Wt){((o=(m=a.value)==null?void 0:m.paymentProviderDetails)==null?void 0:o.provider)===C.SQUARE&&a.value.squareMerchantGatewayId?Z(Oe):(await Y(),B.value=!0);return}else await Y(),N.value=!1,await me({});return}}if(O.value.amount>0&&ie("provider").value!=="pp"){const Q=Ze();if(!Q)return;const j=await De(h,Q);if(j.paymentProvider==="gift_card"){await Y(),B.value=!0;return}if(j.paymentProvider==="free-checkout"){((v=(f=a.value)==null?void 0:f.paymentProviderDetails)==null?void 0:v.provider)===C.SQUARE&&a.value.squareMerchantGatewayId?Z(Oe):(await Y(),B.value=!0);return}}if(we===C.CUSTOM_PROVIDER&&(b!=null&&b.manualPaymentMethodId)){Z(lt,b==null?void 0:b.manualPaymentMethodId);return}if(ie("provider").value==="pp"){He.value=!0,Z(mt);return}else{if((((r=(P=a.value)==null?void 0:P.paymentProviderDetails)==null?void 0:r.provider)===C.AUTHORIZE_NET||((M=(S=a.value)==null?void 0:S.paymentProviderDetails)==null?void 0:M.provider)===C.WHITE_LABEL&&((w=(T=a.value)==null?void 0:T.paymentProviderDetails)==null?void 0:w.whiteLabelProvider)===C.AUTHORIZE_NET)&&a.value.merchantLoginId){Z(yt);return}else if((((n=(I=a.value)==null?void 0:I.paymentProviderDetails)==null?void 0:n.provider)===C.NMI||((W=(F=a.value)==null?void 0:F.paymentProviderDetails)==null?void 0:W.provider)===C.WHITE_LABEL&&((Pe=(se=a.value)==null?void 0:se.paymentProviderDetails)==null?void 0:Pe.whiteLabelProvider)===C.NMI)&&a.value.nmiMerchantGatewayId){Z(pt);return}else if(((be=(Ie=a.value)==null?void 0:Ie.paymentProviderDetails)==null?void 0:be.provider)===C.SQUARE&&a.value.squareMerchantGatewayId){Z(Oe);return}else if(K.value){await Dt(C.CUSTOM_PROVIDER);return}else if(((Se=(Ee=a.value)==null?void 0:Ee.paymentProviderDetails)==null?void 0:Se.provider)===C.ADYEN){Z(vt);return}const Q=a.value.stripePublishableKey,j=a.value.stripeAccountId,Ne=a.value.stripePublishableKey;if(Q&&Ne)_e.value=await va.loadStripe(Q,{stripeAccount:j||void 0});else{alert("Stripe account not found!");return}At()}}else Mt();break}case"click-to-call":{const s=i.element.extra;ht(s[X.PHONE_NUMBER].value);break}case"click-to-sms":{const s=i.element.extra;Pt(s[X.PHONE_NUMBER].value);break}case"click-to-mail":{const s=i.element.extra;gt(s[X.EMAIL_ADDRESS].value);break}case E.DOWNLOAD_FILE:{const s=i.element.extra;if(s[X.DOWNLOAD_FILE].value&&s[X.DOWNLOAD_FILE].value.fileUrl){q.value=!0;try{await It(s[X.DOWNLOAD_FILE].value)}catch(x){console.error("Download failed:",x)}finally{q.value=!1}}break}case E.GO_TO_MEMBERSHIP:{try{let s;const x=a.value.locationId,{ct:b,previewUrl:we}=ie(`_mf_${x}`).value;location.hostname==="localhost"?s=`http://localhost:4040/library/?domain=${we}&token=${b}&location_id=${x}`:s=`${we}/library?&token=${b}&location_id=${x}`,Ce({url:s,newTab:!1})}catch{alert("Sorry something went wrong.")}break}default:console.error(`Invalid action type received: ${e.value}`)}}const Ze=()=>{let e=localStorage.getItem("_ud");e&&(e=JSON.parse(e),sessionStorage.setItem("contactResponse",JSON.stringify(e)));const t=e==null?void 0:e.customer_id;if(!t){A.value="Contact not found!";return}return t};function me(e){var t,l,c,d,m,o,f;try{const v=e==null?void 0:e.membershipPurchase;v!=null&&v.length&&Ve(h,v[0].token);const P=e==null?void 0:e.membershipToken;P&&Ve(h,P),ta(()=>{oa("track","Upsell")});const{saleAction:r,stepPath:S,visitWebsite:M}=i.element.extra;if(!r)if(a.value.funnelNextStep){ue();return}else throw new Error("Redirect not handled");if(a.value.orderFormVersion===2){const T=`_pl_${a.value.funnelId}`,w=localStorage.getItem(T);if(w){let I=JSON.parse(w);I.products.push(O.value),I.total+=(l=(t=u.value)==null?void 0:t.order)==null?void 0:l.amount,I.tax=(m=(d=(c=u.value)==null?void 0:c.order)==null?void 0:d.taxSummary)==null?void 0:m.map(n=>{var W;const F=(W=I==null?void 0:I.tax)==null?void 0:W.find(se=>se._id===n._id);return F?{...F,amount:F.amount+n.amount}:n}),I.orderIds=[u.value.order._id,...I.orderIds],ct(T,JSON.stringify(I))}}else{const T=`_pl_v1_${a.value.funnelId}`,w=localStorage.getItem(T);if(w){let I=JSON.parse(w);I.push((f=(o=i==null?void 0:i.element.extra)==null?void 0:o.productId)==null?void 0:f.value),ct(T,JSON.stringify(I))}}switch(r.value){case"url":if(M&&M.value&&M.value.url){Ce(M.value);break}else throw new Error("Redirect not handled");case"step-path":if(S&&S.value){ue(S.value);break}else throw new Error("Redirect not handled");default:if(a.value.funnelNextStep){ue();break}else throw new Error("Redirect not handled")}}catch(v){{const P=JSON.parse(localStorage.getItem("_ud")||"{}");console.log(v);const r=Fe.includes(localStorage.getItem(`pmt_${a.value.funnelId}_${P==null?void 0:P.id}`)||"")?"We are proccessing your order with the bank. We'll confirm you order after bank's confirmation.":`Order successfully placed! 
 However, Something went wrong while displaying this webpage, please contact the seller.`;alert(r)}_.value=!1;return}}const Y=async()=>{var c,d;a.value.countryList.length===0&&await ua();const e=Me(()=>{var m;return((m=ca(he==null?void 0:he.value))==null?void 0:m.states.map(o=>({iso:o.code,name:o.name})))??[]});let t=localStorage.getItem("_ud");t&&(t=JSON.parse(t),sessionStorage.setItem("contactResponse",JSON.stringify(t)));const l=t==null?void 0:t.customer_id;if(!l){A.value="Contact not found!";return}if(ce.value&&!J.value){de.value="Invalid Captcha!",N.value=!1,_.value=!1;return}if(ge.value=((c=e.value.find(m=>m.name===(t==null?void 0:t.state)))==null?void 0:c.iso)??"",G.value.contact.shippingAddress.state=ge.value,u.value=await da({contactId:l,domain:a.value.domain,pageUrl:a.value.pageUrl,locationId:h,productPreviewList:[{_id:H,qty:1}],store:a.value,subType:sa.UPSELL,traceId:t==null?void 0:t.traceId,reCaptchaToken:J.value,toZip:t.postal_code,toState:ge.value,toCountry:t.country,toCity:t.city,toStreetAddress:t.address1}),J.value=void 0,(d=u.value)!=null&&d.error){u.value.status===429&&(ce.value=!0),A.value=u.value.message??"Error creating order!",N.value=!1,_.value=!1;return}sessionStorage.setItem("orderResponse",JSON.stringify(u.value))};async function At(){var e,t,l,c,d,m,o,f,v,P;try{if(!H)throw new Error("No product Id found for initiating stripe payment");if(A.value="",await Y(),U.value.amount=(t=(e=u.value)==null?void 0:e.order)==null?void 0:t.amount,U.value.currency=oe.value.toLowerCase(),U.value.mode=((l=O.value)==null?void 0:l.price.type)==="recurring"?"subscription":"payment",!((d=(c=u.value)==null?void 0:c.order)!=null&&d.amount)&&((m=O.value)==null?void 0:m.price.type)!=="recurring"&&(U.value.mode="setup"),!u.value||(o=u.value)!=null&&o.error)return;let r={};r={altId:h,altType:"location",orderId:u.value.order._id,reCaptchaToken:J.value};const S=JSON.parse(localStorage.getItem("_ud")||"{}");Fe.includes(localStorage.getItem(`pmt_${a.value.funnelId}_${S==null?void 0:S.id}`)||"")&&(r.paymentMethodTypes=[ve.sepa]);const M=await De(h,(f=u.value.order)==null?void 0:f.contactId),T=localStorage.getItem(`pmt_${a.value.funnelId}_${S==null?void 0:S.id}`)||"",w=M.paymentMethod||T;if(!!["klarna","affirm","afterpay_clearpay","amazon_pay","revolut_pay","zip","grabpay","fpx"].includes(w)||((v=u.value.order)==null?void 0:v.amount)===0&&w===ve.bacs){B.value=!0;return}const n=await ee.initiateStripePayment(r);if(!n.success){A.value=n.message||"We're sorry, but something went wrong. Please try again.";return}const{clientSecret:F,paymentMethodId:W}=n;if(F&&![ve.bacs,ve.cashapp].includes(w)){let b={};if(Fe.includes(T)?b=await _e.value.confirmSepaDebitPayment(F,{payment_method:W}):w===ve.becs?b=await _e.value.confirmAuBecsDebitPayment(F,{payment_method:W}):b=await _e.value.confirmCardPayment(F,{payment_method:W,setup_future_usage:"off_session"}),b.error){console.error("Failed to confirm card payment!",b.error),b.error.message&&alert(b.error.message);return}}const{orderId:se,paymentIntentId:Pe,subscriptionId:Ie,invoiceId:be,subId:Ee,txnId:Se}=n,s={altId:h,altType:"location",orderId:se,paymentIntentId:Pe,subscriptionId:Ie,invoiceId:be,isAuth:!1,subId:Ee,txnId:Se,attribution:{eventData:ke(),sessionId:Te(h),sessionFingerprint:xe(h)}},x=await ee.verifyStripePayment(s);if(!x.success){A.value=x.message||"We're sorry, but something went wrong. Please try again.";return}await me(x)}catch(r){if(((P=r==null?void 0:r.response)==null?void 0:P.status)===429){ce.value=!0,N.value=!1,_.value=!1;return}A.value=dt(r),_.value=!1,console.error(r)}}async function Z(e,t){var l,c,d,m,o;try{if(!H)throw new Error(`No product Id found for initiating ${e||"stripe"} payment`);if(N.value=!0,A.value="",await Y(),!u.value||(l=u.value)!=null&&l.error)return;let f;if((c=u.value)!=null&&c.order._id){f={altId:h,altType:"location",orderId:(d=u.value)==null?void 0:d.order._id,attribution:{eventData:ke(),sessionId:Te(h),sessionFingerprint:xe(h)}};let v;switch(e){case yt:{v=await ee.authorizeNetOrderPayment(f);break}case pt:{v=await ee.nmiOrderPayment(f);break}case lt:{t&&(f.manualPaymentMethodId=t),v=await ee.customProviderOrderPayment(f);break}case Oe:{const P=await ma(h,(m=u.value.order)==null?void 0:m.contactId);if(!P||P==="false"){Ge.value=((o=O.value)==null?void 0:o.price.type)==="recurring"?"subscription":"",B.value=!0,N.value=!1;return}v=await ee.squareOrderPayment({...f,saveCard:!1});break}case vt:{v=await ee.adyenOrderPayment(f);break}case mt:B.value=!0,N.value=!1;return;default:console.log("Invalid payment provider");break}if(console.error(v),N.value=!1,!v.success){A.value=v.message||"We're sorry, but something went wrong. Please try again.";return}await me({membershipPurchase:v.membershipPurchase,membershipToken:v.membershipToken})}}catch(f){_.value=!1,N.value=!1,console.error(f),A.value=dt(f)}}async function Mt(){if(H)try{const e=la(),t={...ke(),fbEventId:e},l=Te(h),c=xe(h),d=await ft.funnelPayment({fingerprint:ie("msgsndr_id").value,productList:[H],locationId:h,funnelId:wt,stepId:Ot,pageId:kt,domain:a.value.domain,pageUrl:a.value.pageUrl,source:"payment_button",submissionType:3,eventData:t,sessionId:l,sessionFingerprint:c,_mp:ie("_mp").value});await me(d)}catch(e){console.error(e)}finally{_.value=!0}}function Qe(){var t,l,c,d,m;let e="";switch(te){case E.CLICK_TO_CALL:{let o=(t=i.element.extra[X.PHONE_NUMBER])==null?void 0:t.value;o=o==null?void 0:o.replace("tel:",""),e=`tel:${o}`;break}case E.CLICK_TO_SMS:{let o=(l=i.element.extra[X.PHONE_NUMBER])==null?void 0:l.value;o=o==null?void 0:o.replace("sms:",""),e=`sms:${o}`;break}case E.GO_TO_URL:{e=V==null?void 0:V.url,e=Ae(e),e&&!e.startsWith("#")&&!/^https?:/.test(e)&&!e.toLowerCase().startsWith("mailto:")&&!e.toLowerCase().startsWith("tel:")&&!e.toLowerCase().startsWith("sms:")&&(e=`https://${e}`),Re.value=V!=null&&V.newTab?"_blank":"";break}case E.GO_TO_STEP:{const o=(m=(d=(c=i.element)==null?void 0:c.extra)==null?void 0:d.stepPath)==null?void 0:m.value;e=bt(o,!1);break}}return e}async function Ut(e){if(a.value.videoExistsInPage&&We.$emit("handle-redirect"),te===E.GO_TO_STEP){const t=i.element.extra.stepPath.value;Et(e,t)}}function Ft(){B.value=!1,_.value=!1,D.value=!1}async function Dt(e){var l,c,d,m,o;if(!H)throw new Error("No product Id found for initiating stripe payment");if(A.value="",await Y(),!((c=(l=u.value)==null?void 0:l.order)!=null&&c._id&&e===C.CUSTOM_PROVIDER))return;const t={source:"order",sourceId:(m=(d=u==null?void 0:u.value)==null?void 0:d.order)==null?void 0:m._id,sourceDetails:u.value.order,traceId:u.value.traceId,extra:{attribution:{eventData:ke(),sessionId:Te(h),sessionFingerprint:xe(h)}},captchaToken:J.value};(o=ze.value)==null||o.confirmPayment(t)}return(e,t)=>{const l=fa,c=_a,d=ha;return k(),L(Xt,null,[fe.value?(k(),L("a",{key:0,id:`${p.element.id}_btn`,href:Le.value,target:Re.value,rel:Re.value==="_blank"?"noreferrer noopener":void 0,"data-animation-class":g(ye),class:ot([p.classStyles,"text-center"]),style:le(g(st)(g(ye))?"opacity: 0":""),onClick:t[0]||(t[0]=m=>Ut(m)),"aria-label":Ke()},[$("span",{style:le(_.value?"visibility: hidden;":""),class:"main-heading-group"},[p.element.extra.icon!==""?(k(),L("span",Pa)):R("",!0),$("span",Ia,ae(g(re)),1),p.element.extra.icon!==""?(k(),L("span",ba)):R("",!0)],4),p.element.extra.subText&&p.element.extra.subText.value?(k(),L("span",{key:0,style:le(_.value?"visibility: hidden;":""),class:"sub-heading-group text-xs font-sans"},[$("span",Ea,ae(g(ne)),1)],4)):R("",!0)],14,ga)):R("",!0),ce.value?(k(),L("section",Sa,[Ue(l,{onExpired:t[1]||(t[1]=()=>J.value=""),onVerify:Lt}),de.value?(k(),L("p",wa,ae(de.value),1)):R("",!0)])):R("",!0),fe.value?R("",!0):(k(),L("button",{key:2,disabled:_.value||g(K)&&D.value||q.value,"data-animation-class":g(ye),id:`${p.element.id}_btn`,style:le(_.value||g(K)&&D.value||q.value?"cursor: default;":g(st)(g(ye))?"opacity: 0":""),class:ot([p.classStyles]),onClick:Nt,"aria-label":Ke()},[$("div",{style:le(_.value||g(K)&&D.value||q.value?"visibility: hidden;":""),class:"main-heading-group"},[p.element.extra.icon!==""?(k(),L("div",ka)):R("",!0),$("div",Ta,ae(g(re)),1),p.element.extra.icon!==""?(k(),L("div",xa)):R("",!0)],4),p.element.extra.subText&&p.element.extra.subText.value?(k(),L("div",{key:0,style:le(_.value||g(K)&&D.value||q.value?"visibility: hidden;":""),class:"text-xs font-sans"},[$("div",Ca,ae(g(ne)),1)],4)):R("",!0),Yt($("div",La,[Ue(ya,{loading:_.value||g(K)&&D.value||q.value,color:"rgb(255, 255, 255)",size:"30px"},null,8,["loading"])],512),[[Zt,_.value||g(K)&&D.value||q.value]])],14,Oa)),$("div",null,[qe.value&&g(a).funnelPageId&&g(K)?(k(),L("section",Ra,[$("div",{id:`${p.element.id}-payment-form`,class:"payment-form"},[Ue(c,{id:`${p.element.id}-payment-element`,ref_key:"confirmPaymentRef",ref:ze,customProviderProps:G.value,onPaymentCallback:xt},null,8,["id","customProviderProps"]),z.value?(k(),L("div",Aa,[t[2]||(t[2]=$("img",{src:aa,alt:"alert"},null,-1)),Qt(" "+ae(z.value),1)])):R("",!0)],8,Na)])):R("",!0)]),A.value?(k(),L("div",Ma,ae(A.value),1)):R("",!0),B.value?(k(),jt(d,{key:4,extra:i.element.extra,stripeOptions:U.value,order:u.value,traceId:u.value.traceId,element:i.element,styles:p.classStyles,squarePaymentMode:Ge.value,showPaypal:He.value&&oe.value,customProviderProps:G.value,paymentProps:{currency:oe.value,mode:g(Tt)?"subscription":"onetime"},onClosePaymentElementModal:Ft},null,8,["extra","stripeOptions","order","traceId","element","styles","squarePaymentMode","showPaypal","customProviderProps","paymentProps"])):R("",!0)],64)}}});export{rr as default};
